{
  "properties": {
    "connectionReferences": {
      "shared_commondataserviceforapps": {
        "runtimeSource": "embedded",
        "connection": {
          "connectionReferenceLogicalName": "vl_sharedcommondataserviceforapps_04816"
        },
        "api": {
          "name": "shared_commondataserviceforapps"
        }
      }
    },
    "definition": {
      "$schema": "https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#",
      "contentVersion": "1.0.0.0",
      "parameters": {
        "$connections": {
          "defaultValue": {},
          "type": "Object"
        },
        "$authentication": {
          "defaultValue": {},
          "type": "SecureObject"
        }
      },
      "triggers": {
        "When_Serviceability_Request_Received": {
          "metadata": {
            "operationMetadataId": "599d90b7-f98c-4140-a658-e0063b6e5d1d"
          },
          "type": "OpenApiConnectionWebhook",
          "inputs": {
            "host": {
              "connectionName": "shared_commondataserviceforapps",
              "operationId": "SubscribeWebhookTrigger",
              "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
            },
            "parameters": {
              "subscriptionRequest/message": 1,
              "subscriptionRequest/entityname": "vl_workflowqueue",
              "subscriptionRequest/scope": 4,
              "subscriptionRequest/filterexpression": "vl_queuetype eq 127420001"
            },
            "authentication": "@parameters('$authentication')"
          }
        }
      },
      "actions": {
        "Main": {
          "actions": {
            "Get_Active_License": {
              "runAfter": {},
              "metadata": {
                "operationMetadataId": "0e9a4c0e-77c5-4912-9aaa-cffe98b9cf03"
              },
              "type": "OpenApiConnection",
              "inputs": {
                "host": {
                  "connectionName": "shared_commondataserviceforapps",
                  "operationId": "ListRecords",
                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                },
                "parameters": {
                  "entityName": "vl_licenses",
                  "$filter": "vl_licensestatus eq true"
                },
                "authentication": "@parameters('$authentication')"
              }
            },
            "Get_Active_Configuration": {
              "runAfter": {
                "Get_Active_License": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "193c63c5-e908-45a0-8500-5191520f2ffc"
              },
              "type": "OpenApiConnection",
              "inputs": {
                "host": {
                  "connectionName": "shared_commondataserviceforapps",
                  "operationId": "ListRecords",
                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                },
                "parameters": {
                  "entityName": "vl_configurationsettingses",
                  "$filter": "_vl_licenseid_value eq '@{first(body('Get_Active_License')?['value'])?['vl_licenseid']}'"
                },
                "authentication": "@parameters('$authentication')"
              }
            },
            "Get_Application_Details": {
              "runAfter": {
                "Get_Active_Configuration": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "ac22e8e7-0702-4c98-8d3c-651419dea393"
              },
              "type": "OpenApiConnection",
              "inputs": {
                "host": {
                  "connectionName": "shared_commondataserviceforapps",
                  "operationId": "GetItem",
                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                },
                "parameters": {
                  "entityName": "vl_applicationses",
                  "recordId": "@triggerOutputs()?['body/_vl_applicationid_value']"
                },
                "authentication": "@parameters('$authentication')"
              }
            },
            "Set_varMinNetMonthlySurplus": {
              "runAfter": {
                "Set_varLoanAmount": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "c10d914b-2785-457c-9f0b-97281a7edc82"
              },
              "type": "SetVariable",
              "inputs": {
                "name": "varMinNetMonthlySurplus",
                "value": "@first(body('Get_Active_Configuration')?['value'])?['vl_minimumnetmonthlysurplus']"
              }
            },
            "Set_varMinDTI": {
              "runAfter": {
                "Set_varMinNetMonthlySurplus": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "77bb5d95-f4e9-4749-9542-afb092aba4ab"
              },
              "type": "SetVariable",
              "inputs": {
                "name": "varMinDTI",
                "value": "@first(body('Get_Active_Configuration')?['value'])?['vl_minimumdebttoincomeratio']"
              }
            },
            "Set_varMaxDTI": {
              "runAfter": {
                "Set_varMinDTI": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "d30d1032-770a-4740-9e4b-b618a73329d1"
              },
              "type": "SetVariable",
              "inputs": {
                "name": "varMaxDTI",
                "value": "@first(body('Get_Active_Configuration')?['value'])?['vl_maximumdebttoincomeratio']"
              }
            },
            "Set_varMinDSR": {
              "runAfter": {
                "Set_varMaxDTI": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "a87863f7-701e-4dbf-aeee-1804b519031e"
              },
              "type": "SetVariable",
              "inputs": {
                "name": "varMinDSR",
                "value": "@first(body('Get_Active_Configuration')?['value'])?['vl_minimumdebtservicingratio']"
              }
            },
            "Set_varMaxDSR": {
              "runAfter": {
                "Set_varMinDSR": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "a8368726-00ed-44ab-bca4-58b48a1bf961"
              },
              "type": "SetVariable",
              "inputs": {
                "name": "varMaxDSR",
                "value": "@first(body('Get_Active_Configuration')?['value'])?['vl_maximumdebtservicingratio']"
              }
            },
            "Set_varMinLTI": {
              "runAfter": {
                "Set_varMaxDSR": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "ccda3b62-e3ac-45a1-81c9-e79523cef4f4"
              },
              "type": "SetVariable",
              "inputs": {
                "name": "varMinLTI",
                "value": "@first(body('Get_Active_Configuration')?['value'])?['vl_minimumloantoincomeratio']"
              }
            },
            "Set_varMaxLTI": {
              "runAfter": {
                "Set_varMinLTI": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "610a0bec-6019-4551-810d-226ee6d5770d"
              },
              "type": "SetVariable",
              "inputs": {
                "name": "varMaxLTI",
                "value": "@first(body('Get_Active_Configuration')?['value'])?['vl_maximumloantoincomeratio']"
              }
            },
            "Check_Application_Occupancy": {
              "actions": {
                "Set_Owner_Occupaid_varMinLVR": {
                  "runAfter": {},
                  "metadata": {
                    "operationMetadataId": "9c674b9f-b6a3-4666-94db-7fc59c6aa81d"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varMinLVR",
                    "value": "@first(body('Get_Active_Configuration')?['value'])?['vl_minimumowneroccupiedloantovalueratio']"
                  }
                },
                "Set_Owner_Occupaid_varMaxLVR": {
                  "runAfter": {
                    "Set_Owner_Occupaid_varMinLVR": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "6dd85215-93f9-4e7e-a3ea-88e0326fcd28"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varMaxLVR",
                    "value": "@first(body('Get_Active_Configuration')?['value'])?['vl_maximumowneroccupiedloantovalueratio']"
                  }
                }
              },
              "runAfter": {
                "Set_varMaxLTI": [
                  "Succeeded"
                ]
              },
              "else": {
                "actions": {
                  "Set_Investment_varMinLVR": {
                    "runAfter": {},
                    "metadata": {
                      "operationMetadataId": "cc3c9f21-d73a-4396-9221-6383ac12b6d6"
                    },
                    "type": "SetVariable",
                    "inputs": {
                      "name": "varMinLVR",
                      "value": "@first(body('Get_Active_Configuration')?['value'])?['vl_minimuminvestmentloantovalueratio']"
                    }
                  },
                  "Set_Investment_varMaxLVR": {
                    "runAfter": {
                      "Set_Investment_varMinLVR": [
                        "Succeeded"
                      ]
                    },
                    "metadata": {
                      "operationMetadataId": "ac5aed94-13b4-4fde-9e7c-1e8012e0b700"
                    },
                    "type": "SetVariable",
                    "inputs": {
                      "name": "varMaxLVR",
                      "value": "@first(body('Get_Active_Configuration')?['value'])?['vl_maximuminvestmentloantovalueratio']"
                    }
                  }
                }
              },
              "expression": {
                "equals": [
                  "@outputs('Get_Application_Details')?['body/vl_occupancy']",
                  127420000
                ]
              },
              "metadata": {
                "operationMetadataId": "e7edcab8-b4ed-4be6-beb4-0b158c21d532"
              },
              "type": "If"
            },
            "Get_Applicants_Details": {
              "runAfter": {
                "Check_Application_Occupancy": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "55f82ebf-0b0f-424c-891d-7e8693856905"
              },
              "type": "OpenApiConnection",
              "inputs": {
                "host": {
                  "connectionName": "shared_commondataserviceforapps",
                  "operationId": "ListRecords",
                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                },
                "parameters": {
                  "entityName": "vl_applicants",
                  "$filter": "_vl_applicationid_value eq '@{triggerOutputs()?['body/_vl_applicationid_value']}'",
                  "$orderby": "vl_primaryapplicant desc"
                },
                "authentication": "@parameters('$authentication')"
              }
            },
            "Get_Tax_Brackets": {
              "runAfter": {
                "Filter_Marital_Status": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "345f816d-f3da-4d15-848b-61927097b906"
              },
              "type": "OpenApiConnection",
              "inputs": {
                "host": {
                  "connectionName": "shared_commondataserviceforapps",
                  "operationId": "ListRecords",
                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                },
                "parameters": {
                  "entityName": "vl_taxes",
                  "$orderby": "vl_taxbracketminimum asc"
                },
                "authentication": "@parameters('$authentication')"
              }
            },
            "For_Each_Applicants": {
              "foreach": "@outputs('Get_Applicants_Details')?['body/value']",
              "actions": {
                "Reset_varPAYGIncome": {
                  "runAfter": {},
                  "metadata": {
                    "operationMetadataId": "f34bb716-f541-4921-be08-8bf59e412853"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varPAYGIncome",
                    "value": 0
                  }
                },
                "Reset_varPAYGIncomeEligible": {
                  "runAfter": {
                    "Reset_varPAYGIncome": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "543262ba-cb53-4570-b530-2dd7c67c2f98"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varPAYGIncomeEligible",
                    "value": 0
                  }
                },
                "Reset_varSelfEmployedIncome": {
                  "runAfter": {
                    "Reset_varPAYGIncomeEligible": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "0bb41d9a-0457-4507-bf78-340f8af088d8"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varSelfEmployedIncome",
                    "value": 0
                  }
                },
                "Reset_varSelfEmployedIncomeEligible": {
                  "runAfter": {
                    "Reset_varSelfEmployedIncome": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "cce1a6fe-477e-452f-aae0-4e4ca8fd7fda"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varSelfEmployedIncomeEligible",
                    "value": 0
                  }
                },
                "Reset_varUnEmployedIncome": {
                  "runAfter": {
                    "Reset_varSelfEmployedIncomeEligible": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "90a53004-f03b-44ca-86de-f9168d5e6396"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varUnEmployedIncome",
                    "value": 0
                  }
                },
                "Reset_varUnEmployedIncomeEligible": {
                  "runAfter": {
                    "Reset_varUnEmployedIncome": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "92d4c2a5-f103-4337-8957-79824c0386b7"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varUnEmployedIncomeEligible",
                    "value": 0
                  }
                },
                "Reset_varAnnuities": {
                  "runAfter": {
                    "Reset_varUnEmployedIncomeEligible": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "f9bbb221-f188-4925-9683-ec153537a991"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varAnnuities",
                    "value": 0
                  }
                },
                "Reset_varAnnuitiesEligible": {
                  "runAfter": {
                    "Reset_varAnnuities": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "88c8f91e-5b48-4aab-8c58-540bc16787f2"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varAnnuitiesEligible",
                    "value": 0
                  }
                },
                "Reset_varChildMaintanance": {
                  "runAfter": {
                    "Reset_varAnnuitiesEligible": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "50cb9b68-1741-4bee-8a37-5cec7658e595"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varChildMaintanance",
                    "value": 0
                  }
                },
                "Reset_varChildMaintananceEligible": {
                  "runAfter": {
                    "Reset_varChildMaintanance": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "bae16509-7a49-405a-a78e-12b80d926360"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varChildMaintananceEligible",
                    "value": 0
                  }
                },
                "Reset_varDividends": {
                  "runAfter": {
                    "Reset_varChildMaintananceEligible": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "e6fffb40-9465-48d7-ab46-6108b68af663"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varDividends",
                    "value": 0
                  }
                },
                "Reset_varDividendsEligible": {
                  "runAfter": {
                    "Reset_varDividends": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "a1dcd1ee-e5f1-4b0c-8274-f55fa13fb684"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varDividendsEligible",
                    "value": 0
                  }
                },
                "Reset_varForeignSourced": {
                  "runAfter": {
                    "Reset_varDividendsEligible": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "d83c19a4-3707-4ad1-b964-5727481ecb63"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varForeignSourced",
                    "value": 0
                  }
                },
                "Reset_varForeignSourcedEligible": {
                  "runAfter": {
                    "Reset_varForeignSourced": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "bb21d78c-63ee-481c-acf4-af42fff9673d"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varForeignSourcedEligible",
                    "value": 0
                  }
                },
                "Reset_varGovtBenefits": {
                  "runAfter": {
                    "Reset_varForeignSourcedEligible": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "9195a9c4-014e-40ad-ab23-824295031706"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varGovtBenefits",
                    "value": 0
                  }
                },
                "Reset_varGovtBenefitsEligible": {
                  "runAfter": {
                    "Reset_varGovtBenefits": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "21658152-9193-4397-b9f7-ed1af67705ff"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varGovtBenefitsEligible",
                    "value": 0
                  }
                },
                "Reset_varInvestmentIncome": {
                  "runAfter": {
                    "Reset_varGovtBenefitsEligible": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "9137d185-ca18-44a4-8dd1-0c1d4dd94206"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varInvestmentIncome",
                    "value": 0
                  }
                },
                "Reset_varInvestmentIncomeEligible": {
                  "runAfter": {
                    "Reset_varInvestmentIncome": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "83ab2669-e458-424e-ba35-3275615e4d68"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varInvestmentIncomeEligible",
                    "value": 0
                  }
                },
                "Reset_varOtherIncome": {
                  "runAfter": {
                    "Reset_varInvestmentIncomeEligible": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "ea2da2f5-cb29-4c8c-a74a-4e2753185b65"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varOtherIncome",
                    "value": 0
                  }
                },
                "Reset_varOtherIncomeEligible": {
                  "runAfter": {
                    "Reset_varOtherIncome": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "afae5787-0d21-4e66-914f-7cbc15437c3d"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varOtherIncomeEligible",
                    "value": 0
                  }
                },
                "Reset_varRentalIncome": {
                  "runAfter": {
                    "Reset_varOtherIncomeEligible": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "b8e28438-b601-491e-a0bb-8c2d3588cb6d"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varRentalIncome",
                    "value": 0
                  }
                },
                "Rest_varRentalIncomeEligible": {
                  "runAfter": {
                    "Reset_varRentalIncome": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "8b429258-6c81-440a-96e4-18422bb31ab2"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varRentalIncomeEligible",
                    "value": 0
                  }
                },
                "Reset_varWorkersCompensation": {
                  "runAfter": {
                    "Rest_varRentalIncomeEligible": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "b1ed500b-c7d9-4ffc-8b16-157a88157f61"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varWorkersCompensation",
                    "value": 0
                  }
                },
                "Reset_varWorkersCompensationEligible": {
                  "runAfter": {
                    "Reset_varWorkersCompensation": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "9df45532-28ed-4dd9-93fe-f5add94c2202"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varWorkersCompensationEligible",
                    "value": 0
                  }
                },
                "Reset_varGrossIncome": {
                  "runAfter": {
                    "Reset_varWorkersCompensationEligible": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "7ff7b474-6e3d-4636-bf28-05763b326ecd"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varGrossIncome",
                    "value": 0
                  }
                },
                "Reset_varGrossIncomeEligible": {
                  "runAfter": {
                    "Reset_varGrossIncome": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "32a5c648-2229-4c6a-95e6-66cf3c694625"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varGrossIncomeEligible",
                    "value": 0
                  }
                },
                "For_Each_Employments": {
                  "foreach": "@outputs('Get_Employment_Details')?['body/value']",
                  "actions": {
                    "Switch_Income_Type": {
                      "runAfter": {},
                      "cases": {
                        "PAYG": {
                          "case": 127420000,
                          "actions": {
                            "Get_PAYG_Employment": {
                              "runAfter": {},
                              "metadata": {
                                "operationMetadataId": "2d1c64ed-2ff8-43d8-aa60-f0d261013e16"
                              },
                              "type": "OpenApiConnection",
                              "inputs": {
                                "host": {
                                  "connectionName": "shared_commondataserviceforapps",
                                  "operationId": "ListRecords",
                                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                },
                                "parameters": {
                                  "entityName": "vl_paygemployments",
                                  "$filter": "_vl_employmentuserid_value eq '@{items('For_Each_Employments')?['vl_employmentid']}'",
                                  "$top": 1
                                },
                                "authentication": "@parameters('$authentication')"
                              }
                            },
                            "Increment_varPAYGIncome": {
                              "runAfter": {
                                "Get_PAYG_Employment": [
                                  "Succeeded"
                                ]
                              },
                              "metadata": {
                                "operationMetadataId": "6b89ce87-277e-474c-bba1-8b7c03d1b8a2"
                              },
                              "type": "IncrementVariable",
                              "inputs": {
                                "name": "varPAYGIncome",
                                "value": "@if(empty(string(first(body('Get_PAYG_Employment')?['value'])?['vl_grosstotalannualincome'])),0,first(body('Get_PAYG_Employment')?['value'])?['vl_grosstotalannualincome'])"
                              }
                            },
                            "Increment_varPAYGIncomeEligible": {
                              "runAfter": {
                                "Increment_varPAYGIncome": [
                                  "Succeeded"
                                ]
                              },
                              "metadata": {
                                "operationMetadataId": "da4a875d-78b9-4f14-a047-e377a28f1d21"
                              },
                              "type": "IncrementVariable",
                              "inputs": {
                                "name": "varPAYGIncomeEligible",
                                "value": "@if(empty(string(first(body('Get_PAYG_Employment')?['value'])?['vl_grosseligibletotalannualincome'])),0,first(body('Get_PAYG_Employment')?['value'])?['vl_grosseligibletotalannualincome'])"
                              }
                            },
                            "Increment_PAYG_varEmploymentIncomeCreditAdjustment": {
                              "runAfter": {
                                "Increment_varPAYGIncomeEligible": [
                                  "Succeeded"
                                ]
                              },
                              "metadata": {
                                "operationMetadataId": "841902dc-1027-4681-b527-a3c2c449dfbc"
                              },
                              "type": "IncrementVariable",
                              "inputs": {
                                "name": "varPAYGEmploymentIncomeCreditAdjustment",
                                "value": "@if(empty(string(first(body('Get_PAYG_Employment')?['value'])?['vl_creditadjustment'])),0,first(body('Get_PAYG_Employment')?['value'])?['vl_creditadjustment'])"
                              }
                            }
                          }
                        },
                        "Self_Employed": {
                          "case": 127420001,
                          "actions": {
                            "Get_Self_Employed_Employment": {
                              "runAfter": {},
                              "metadata": {
                                "operationMetadataId": "a1e2d224-8bde-4909-ad4e-a7a422e50dc0"
                              },
                              "type": "OpenApiConnection",
                              "inputs": {
                                "host": {
                                  "connectionName": "shared_commondataserviceforapps",
                                  "operationId": "ListRecords",
                                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                },
                                "parameters": {
                                  "entityName": "vl_selfemployedemployments",
                                  "$filter": "_vl_employmentuserid_value eq '@{items('For_Each_Employments')?['vl_employmentid']}'",
                                  "$top": 1
                                },
                                "authentication": "@parameters('$authentication')"
                              }
                            },
                            "Compare_Current_And_Previous_Income": {
                              "actions": {
                                "Increment_Current_varSelfEmploymentIncome": {
                                  "runAfter": {},
                                  "metadata": {
                                    "operationMetadataId": "29377f39-213d-4b9d-a3cd-4f577c7d1209"
                                  },
                                  "type": "IncrementVariable",
                                  "inputs": {
                                    "name": "varSelfEmployedIncome",
                                    "value": "@if(empty(string(first(body('Get_Self_Employed_Employment')?['value'])?['vl_currenttotalgrossannualincome'])),0,first(body('Get_Self_Employed_Employment')?['value'])?['vl_currenttotalgrossannualincome'])"
                                  }
                                },
                                "Increment_Current_varSelfEmployedIncomeEligible_": {
                                  "runAfter": {
                                    "Increment_Current_varSelfEmploymentIncome": [
                                      "Succeeded"
                                    ]
                                  },
                                  "metadata": {
                                    "operationMetadataId": "8cb92377-1ddb-44cb-bb1b-62c5f587cf26"
                                  },
                                  "type": "IncrementVariable",
                                  "inputs": {
                                    "name": "varSelfEmployedIncomeEligible",
                                    "value": "@if(empty(string(first(body('Get_Self_Employed_Employment')?['value'])?['vl_currenttotalgrosseligibleannualincome'])),0,first(body('Get_Self_Employed_Employment')?['value'])?['vl_currenttotalgrosseligibleannualincome'])"
                                  }
                                }
                              },
                              "runAfter": {
                                "Get_Self_Employed_Employment": [
                                  "Succeeded"
                                ]
                              },
                              "else": {
                                "actions": {
                                  "Calculate_Average_Self_Employment": {
                                    "runAfter": {},
                                    "metadata": {
                                      "operationMetadataId": "9a3fc5d5-e83d-4634-83c6-cf4534b622a7"
                                    },
                                    "type": "Compose",
                                    "inputs": "@div(add(first(body('Get_Self_Employed_Employment')?['value'])?['vl_currenttotalgrossannualincome'],first(body('Get_Self_Employed_Employment')?['value'])?['vl_previoustotalgrossannualincome']),2)"
                                  },
                                  "Calculate_Average_Eligible_Self_Employment": {
                                    "runAfter": {
                                      "Calculate_Average_Self_Employment": [
                                        "Succeeded"
                                      ]
                                    },
                                    "metadata": {
                                      "operationMetadataId": "5a16f79e-1231-42c2-a576-549b01c84449"
                                    },
                                    "type": "Compose",
                                    "inputs": "@div(add(first(body('Get_Self_Employed_Employment')?['value'])?['vl_currenttotalgrosseligibleannualincome'],first(body('Get_Self_Employed_Employment')?['value'])?['vl_previoustotalgrosseligibleannualincome']),2)"
                                  },
                                  "Increment_Average_varSelfEmployedIncome": {
                                    "runAfter": {
                                      "Calculate_Average_Eligible_Self_Employment": [
                                        "Succeeded"
                                      ]
                                    },
                                    "metadata": {
                                      "operationMetadataId": "09fdf995-539e-4f3b-8704-1ec78aa60943"
                                    },
                                    "type": "IncrementVariable",
                                    "inputs": {
                                      "name": "varSelfEmployedIncome",
                                      "value": "@if(empty(string(outputs('Calculate_Average_Self_Employment'))),0,outputs('Calculate_Average_Self_Employment'))"
                                    }
                                  },
                                  "Increment_Average_Eligible_varSelfEmploymentIncome": {
                                    "runAfter": {
                                      "Increment_Average_varSelfEmployedIncome": [
                                        "Succeeded"
                                      ]
                                    },
                                    "metadata": {
                                      "operationMetadataId": "a1133e9c-f756-449b-b916-c2a3f6e2b5f2"
                                    },
                                    "type": "IncrementVariable",
                                    "inputs": {
                                      "name": "varSelfEmployedIncomeEligible",
                                      "value": "@if(empty(string(outputs('Calculate_Average_Eligible_Self_Employment'))),0,outputs('Calculate_Average_Eligible_Self_Employment'))"
                                    }
                                  }
                                }
                              },
                              "expression": {
                                "less": [
                                  "@first(body('Get_Self_Employed_Employment')?['value'])?['vl_currenttotalgrosseligibleannualincome']",
                                  "@first(body('Get_Self_Employed_Employment')?['value'])?['vl_previoustotalgrosseligibleannualincome']"
                                ]
                              },
                              "metadata": {
                                "operationMetadataId": "88387f14-eb4c-44b1-bc28-2824753d316b"
                              },
                              "type": "If"
                            },
                            "Increment_Self_Employment_varEmploymentIncomeCreditAdjustment": {
                              "runAfter": {
                                "Compare_Current_And_Previous_Income": [
                                  "Succeeded"
                                ]
                              },
                              "metadata": {
                                "operationMetadataId": "60c62ca0-1a83-4ed1-80ea-0377cd26967e"
                              },
                              "type": "IncrementVariable",
                              "inputs": {
                                "name": "varEmploymentIncomeCreditAdjustment",
                                "value": "@if(empty(string(first(body('Get_Self_Employed_Employment')?['value'])?['vl_creditadjustment'])),0,first(body('Get_Self_Employed_Employment')?['value'])?['vl_creditadjustment'])"
                              }
                            }
                          }
                        },
                        "UnEmployed": {
                          "case": 127420002,
                          "actions": {
                            "Get_UnEmployed_Employment": {
                              "runAfter": {},
                              "metadata": {
                                "operationMetadataId": "e2c82c62-c950-4bef-b4bf-7b0be2ccc1ac"
                              },
                              "type": "OpenApiConnection",
                              "inputs": {
                                "host": {
                                  "connectionName": "shared_commondataserviceforapps",
                                  "operationId": "ListRecords",
                                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                },
                                "parameters": {
                                  "entityName": "vl_unemployedemployments",
                                  "$filter": "_vl_employmentuserid_value eq '@{items('For_Each_Employments')?['vl_employmentid']}'"
                                },
                                "authentication": "@parameters('$authentication')"
                              }
                            },
                            "Increment_varUnEmployedIncome": {
                              "runAfter": {
                                "Get_UnEmployed_Employment": [
                                  "Succeeded"
                                ]
                              },
                              "metadata": {
                                "operationMetadataId": "d81954c3-ce34-4b64-9cd6-749acaba6836"
                              },
                              "type": "IncrementVariable",
                              "inputs": {
                                "name": "varUnEmployedIncome",
                                "value": "@if(empty(string(first(body('Get_UnEmployed_Employment')?['value'])?['vl_totalgrossunemployedannualincome'])),0,first(body('Get_UnEmployed_Employment')?['value'])?['vl_totalgrossunemployedannualincome'])"
                              }
                            },
                            "Increment_varUnEmployedIncomeEligible": {
                              "runAfter": {
                                "Increment_varUnEmployedIncome": [
                                  "Succeeded"
                                ]
                              },
                              "metadata": {
                                "operationMetadataId": "e3781ad1-f20b-476e-9bed-ffa069e010c4"
                              },
                              "type": "IncrementVariable",
                              "inputs": {
                                "name": "varUnEmployedIncomeEligible",
                                "value": "@if(empty(string(first(body('Get_UnEmployed_Employment')?['value'])?['vl_totalneteligibleunemployedannualincome'])),0,first(body('Get_UnEmployed_Employment')?['value'])?['vl_totalneteligibleunemployedannualincome'])"
                              }
                            }
                          }
                        }
                      },
                      "default": {
                        "actions": {}
                      },
                      "expression": "@items('For_Each_Employments')?['vl_incometype']",
                      "metadata": {
                        "operationMetadataId": "b1dc149c-7283-43fa-b026-9141abfa9597"
                      },
                      "type": "Switch"
                    }
                  },
                  "runAfter": {
                    "Get_Employment_Details": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "711ae1a5-8908-4b2b-afcf-e6af43ce4bf8"
                  },
                  "type": "Foreach"
                },
                "For_Each_Incomes": {
                  "foreach": "@outputs('Get_Income_Details')?['body/value']",
                  "actions": {
                    "Switch_Other_Income_Type": {
                      "runAfter": {},
                      "cases": {
                        "Annuities": {
                          "case": 127420000,
                          "actions": {
                            "Increment_varAnnuities": {
                              "runAfter": {},
                              "metadata": {
                                "operationMetadataId": "f05e3a4a-57a0-4b18-8d31-ce0668d011a6"
                              },
                              "type": "IncrementVariable",
                              "inputs": {
                                "name": "varAnnuities",
                                "value": "@if(empty(string(items('For_Each_Incomes')?['vl_currentyearincome'])),0,items('For_Each_Incomes')?['vl_currentyearincome'])"
                              }
                            },
                            "Increment_varAnnuitiesEligible": {
                              "runAfter": {
                                "Increment_varAnnuities": [
                                  "Succeeded"
                                ]
                              },
                              "metadata": {
                                "operationMetadataId": "144792c5-075a-4ba0-962f-d04151b4b053"
                              },
                              "type": "IncrementVariable",
                              "inputs": {
                                "name": "varAnnuitiesEligible",
                                "value": "@if(empty(string(items('For_Each_Incomes')?['vl_eligibleincome'])),0,items('For_Each_Incomes')?['vl_eligibleincome'])"
                              }
                            }
                          }
                        },
                        "Child_Maintenance": {
                          "case": 127420001,
                          "actions": {
                            "Increment_varChildMaintanance": {
                              "runAfter": {},
                              "metadata": {
                                "operationMetadataId": "60c8cda4-7106-4ce8-b24e-1c7f2fcc005a"
                              },
                              "type": "IncrementVariable",
                              "inputs": {
                                "name": "varChildMaintanance",
                                "value": "@if(empty(string(items('For_Each_Incomes')?['vl_currentyearincome'])),0,items('For_Each_Incomes')?['vl_currentyearincome'])"
                              }
                            },
                            "Increment_varChildMaintananceEligible": {
                              "runAfter": {
                                "Increment_varChildMaintanance": [
                                  "Succeeded"
                                ]
                              },
                              "metadata": {
                                "operationMetadataId": "09e04238-b160-4fd9-a731-3a14d61e145c"
                              },
                              "type": "IncrementVariable",
                              "inputs": {
                                "name": "varChildMaintananceEligible",
                                "value": "@if(empty(string(items('For_Each_Incomes')?['vl_eligibleincome'])),0,items('For_Each_Incomes')?['vl_eligibleincome'])"
                              }
                            }
                          }
                        },
                        "Dividends": {
                          "case": 127420002,
                          "actions": {
                            "Increment_varDividends": {
                              "runAfter": {},
                              "metadata": {
                                "operationMetadataId": "32e64bff-aee9-4050-b0a1-9824b477034b"
                              },
                              "type": "IncrementVariable",
                              "inputs": {
                                "name": "varDividends",
                                "value": "@if(empty(string(items('For_Each_Incomes')?['vl_currentyearincome'])),0,items('For_Each_Incomes')?['vl_currentyearincome'])"
                              }
                            },
                            "Increment_varDividendsEligible": {
                              "runAfter": {
                                "Increment_varDividends": [
                                  "Succeeded"
                                ]
                              },
                              "metadata": {
                                "operationMetadataId": "ddb80179-0524-48fd-b633-c7f86b504676"
                              },
                              "type": "IncrementVariable",
                              "inputs": {
                                "name": "varDividendsEligible",
                                "value": "@if(empty(string(items('For_Each_Incomes')?['vl_eligibleincome'])),0,items('For_Each_Incomes')?['vl_eligibleincome'])"
                              }
                            }
                          }
                        },
                        "Foreign_Sourced": {
                          "case": 127420003,
                          "actions": {
                            "Increment_varForeignSourced": {
                              "runAfter": {},
                              "metadata": {
                                "operationMetadataId": "14165274-e15a-47d2-aa6b-b9fcb04d75ec"
                              },
                              "type": "IncrementVariable",
                              "inputs": {
                                "name": "varForeignSourced",
                                "value": "@if(empty(string(items('For_Each_Incomes')?['vl_currentyearincome'])),0,items('For_Each_Incomes')?['vl_currentyearincome'])"
                              }
                            },
                            "Increment_varForeignSourcedEligible": {
                              "runAfter": {
                                "Increment_varForeignSourced": [
                                  "Succeeded"
                                ]
                              },
                              "metadata": {
                                "operationMetadataId": "2cebe9d9-4fca-40e1-ab8d-911d02d234ea"
                              },
                              "type": "IncrementVariable",
                              "inputs": {
                                "name": "varForeignSourcedEligible",
                                "value": "@if(empty(string(items('For_Each_Incomes')?['vl_eligibleincome'])),0,items('For_Each_Incomes')?['vl_eligibleincome'])"
                              }
                            }
                          }
                        },
                        "Government_Benefits": {
                          "case": 127420004,
                          "actions": {
                            "Increment_varGovtBenefits": {
                              "runAfter": {},
                              "metadata": {
                                "operationMetadataId": "3609b818-3a1f-41d2-8c67-bbbf830e2fc7"
                              },
                              "type": "IncrementVariable",
                              "inputs": {
                                "name": "varGovtBenefits",
                                "value": "@if(empty(string(items('For_Each_Incomes')?['vl_currentyearincome'])),0,items('For_Each_Incomes')?['vl_currentyearincome'])"
                              }
                            },
                            "Increment_varGovtBenefitsEligible": {
                              "runAfter": {
                                "Increment_varGovtBenefits": [
                                  "Succeeded"
                                ]
                              },
                              "metadata": {
                                "operationMetadataId": "a04e382d-38d2-45d9-8a3a-f720f1c2f993"
                              },
                              "type": "IncrementVariable",
                              "inputs": {
                                "name": "varGovtBenefitsEligible",
                                "value": "@if(empty(string(items('For_Each_Incomes')?['vl_eligibleincome'])),0,items('For_Each_Incomes')?['vl_eligibleincome'])"
                              }
                            }
                          }
                        },
                        "Investment_Income": {
                          "case": 127420005,
                          "actions": {
                            "Increment_varInvestmentIncome": {
                              "runAfter": {},
                              "metadata": {
                                "operationMetadataId": "eee750b1-b636-4715-9438-ccbf813be905"
                              },
                              "type": "IncrementVariable",
                              "inputs": {
                                "name": "varInvestmentIncome",
                                "value": "@if(empty(string(items('For_Each_Incomes')?['vl_currentyearincome'])),0,items('For_Each_Incomes')?['vl_currentyearincome'])"
                              }
                            },
                            "Increment_varInvestmentIncomeEligible": {
                              "runAfter": {
                                "Increment_varInvestmentIncome": [
                                  "Succeeded"
                                ]
                              },
                              "metadata": {
                                "operationMetadataId": "518621d5-60a8-419d-ae06-e8b3c263d765"
                              },
                              "type": "IncrementVariable",
                              "inputs": {
                                "name": "varInvestmentIncomeEligible",
                                "value": "@if(empty(string(items('For_Each_Incomes')?['vl_eligibleincome'])),0,items('For_Each_Incomes')?['vl_eligibleincome'])"
                              }
                            }
                          }
                        },
                        "Workers_Compensation": {
                          "case": 127420006,
                          "actions": {
                            "Increment_varWorkersCompensation": {
                              "runAfter": {},
                              "metadata": {
                                "operationMetadataId": "77ca477e-10ec-44eb-814a-1e3220923a66"
                              },
                              "type": "IncrementVariable",
                              "inputs": {
                                "name": "varWorkersCompensation",
                                "value": "@if(empty(string(items('For_Each_Incomes')?['vl_currentyearincome'])),0,items('For_Each_Incomes')?['vl_currentyearincome'])"
                              }
                            },
                            "Increment_varWorkersCompensationEligible": {
                              "runAfter": {
                                "Increment_varWorkersCompensation": [
                                  "Succeeded"
                                ]
                              },
                              "metadata": {
                                "operationMetadataId": "97ecfd2d-9a8a-4d30-bb43-d8faa755321a"
                              },
                              "type": "IncrementVariable",
                              "inputs": {
                                "name": "varWorkersCompensationEligible",
                                "value": "@if(empty(string(items('For_Each_Incomes')?['vl_eligibleincome'])),0,items('For_Each_Incomes')?['vl_eligibleincome'])"
                              }
                            }
                          }
                        },
                        "Other_Income": {
                          "case": 127420007,
                          "actions": {
                            "Increment_varOtherIncome": {
                              "runAfter": {},
                              "metadata": {
                                "operationMetadataId": "bc2ee766-922c-464f-95ce-a3168bbb133d"
                              },
                              "type": "IncrementVariable",
                              "inputs": {
                                "name": "varOtherIncome",
                                "value": "@if(empty(string(items('For_Each_Incomes')?['vl_currentyearincome'])),0,items('For_Each_Incomes')?['vl_currentyearincome'])"
                              }
                            },
                            "Increment_varOtherIncomeEligible": {
                              "runAfter": {
                                "Increment_varOtherIncome": [
                                  "Succeeded"
                                ]
                              },
                              "metadata": {
                                "operationMetadataId": "1b2bac61-8279-4d2f-8499-1e9e6070fc27"
                              },
                              "type": "IncrementVariable",
                              "inputs": {
                                "name": "varOtherIncomeEligible",
                                "value": "@if(empty(string(items('For_Each_Incomes')?['vl_eligibleincome'])),0,items('For_Each_Incomes')?['vl_eligibleincome'])"
                              }
                            }
                          }
                        },
                        "Rental": {
                          "case": 127420008,
                          "actions": {
                            "Increment_varRentalIncome": {
                              "runAfter": {},
                              "metadata": {
                                "operationMetadataId": "9f507915-191a-4c62-9ffe-da52300d4d19"
                              },
                              "type": "IncrementVariable",
                              "inputs": {
                                "name": "varRentalIncome",
                                "value": "@if(empty(string(items('For_Each_Incomes')?['vl_currentyearincome'])),0,items('For_Each_Incomes')?['vl_currentyearincome'])"
                              }
                            },
                            "Increment_varRentalIncomeEligible": {
                              "runAfter": {
                                "Increment_varRentalIncome": [
                                  "Succeeded"
                                ]
                              },
                              "metadata": {
                                "operationMetadataId": "2bcd2cdc-dbf4-46f0-aa61-5b261e68989a"
                              },
                              "type": "IncrementVariable",
                              "inputs": {
                                "name": "varRentalIncomeEligible",
                                "value": "@if(empty(string(items('For_Each_Incomes')?['vl_eligibleincome'])),0,items('For_Each_Incomes')?['vl_eligibleincome'])"
                              }
                            }
                          }
                        }
                      },
                      "default": {
                        "actions": {}
                      },
                      "expression": "@items('For_Each_Incomes')?['vl_otherincometype']",
                      "metadata": {
                        "operationMetadataId": "eef4f3dd-f9d2-4614-8fa3-55d71133027b"
                      },
                      "type": "Switch"
                    }
                  },
                  "runAfter": {
                    "Get_Income_Details": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "c52f65a2-e143-48e5-b427-97821f14c68d"
                  },
                  "type": "Foreach"
                },
                "For_Each_Liabilities": {
                  "foreach": "@outputs('Get_Liabilities_Details')?['body/value']",
                  "actions": {
                    "Increment_varDebtBalance": {
                      "runAfter": {},
                      "metadata": {
                        "operationMetadataId": "6747e2d1-5999-4dd4-a30a-f197ff06c818"
                      },
                      "type": "IncrementVariable",
                      "inputs": {
                        "name": "varDebtBalance",
                        "value": "@if(empty(string(items('For_Each_Liabilities')?['vl_assessmentdebtbalance'])),0,items('For_Each_Liabilities')?['vl_assessmentdebtbalance'])"
                      }
                    },
                    "Increment_varDebtBalanceCreditAdjustment": {
                      "runAfter": {
                        "Increment_varDebtBalance": [
                          "Succeeded"
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "99f68886-2615-452d-8b85-ec7b853888b8"
                      },
                      "type": "IncrementVariable",
                      "inputs": {
                        "name": "varDebtBalanceCreditAdjustment",
                        "value": "@if(empty(string(items('For_Each_Liabilities')?['vl_creditadjustmentfordebtbalance'])),0,items('For_Each_Liabilities')?['vl_creditadjustmentfordebtbalance'])"
                      }
                    },
                    "Check_Asset_Type": {
                      "actions": {},
                      "runAfter": {
                        "Increment_varDebtBalanceCreditAdjustment": [
                          "Succeeded"
                        ]
                      },
                      "else": {
                        "actions": {
                          "Increment_varRepayment": {
                            "runAfter": {},
                            "metadata": {
                              "operationMetadataId": "38e4de16-9adb-467b-9381-26ec745652a0"
                            },
                            "type": "IncrementVariable",
                            "inputs": {
                              "name": "varRepayment",
                              "value": "@if(empty(string(items('For_Each_Liabilities')?['vl_assessmentmonthlyrepayment'])),0,items('For_Each_Liabilities')?['vl_assessmentmonthlyrepayment'])"
                            }
                          }
                        }
                      },
                      "expression": {
                        "equals": [
                          "@items('For_Each_Liabilities')?['vl_assettype']",
                          "New Property"
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "d245954a-0235-4e14-abee-17ab37c465fd"
                      },
                      "type": "If"
                    },
                    "Increment_varRepayment_With_Repayment_Credit_Adjustment": {
                      "runAfter": {
                        "Check_Asset_Type": [
                          "Succeeded"
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "db92fc09-88e9-44c8-b33e-2c21081304ea"
                      },
                      "type": "IncrementVariable",
                      "inputs": {
                        "name": "varRepayment",
                        "value": "@if(empty(string(items('For_Each_Liabilities')?['vl_creditadjustmentforrepayment'])),0,items('For_Each_Liabilities')?['vl_creditadjustmentforrepayment'])"
                      }
                    },
                    "Check_Negative_Gearing": {
                      "actions": {
                        "Check_Applicant_1_Negative_Gearing": {
                          "actions": {
                            "Increment_Applicant1_varNegativeGearing": {
                              "runAfter": {},
                              "metadata": {
                                "operationMetadataId": "436ccaa7-380a-401a-a023-46fefc16e0b8"
                              },
                              "type": "IncrementVariable",
                              "inputs": {
                                "name": "varNegativeGearing",
                                "value": "@if(empty(string(items('For_Each_Liabilities')?['vl_applicant1negativegearing'])),0,items('For_Each_Liabilities')?['vl_applicant1negativegearing'])"
                              }
                            }
                          },
                          "runAfter": {},
                          "else": {
                            "actions": {
                              "Check_Applicant_2_Negative_Gearing": {
                                "actions": {
                                  "Increment_Applicant2_varNegativeGearing": {
                                    "runAfter": {},
                                    "metadata": {
                                      "operationMetadataId": "823ea1b9-5ab7-4254-bc5b-4d668680770f"
                                    },
                                    "type": "IncrementVariable",
                                    "inputs": {
                                      "name": "varNegativeGearing",
                                      "value": "@if(empty(string(items('For_Each_Liabilities')?['vl_applicant2negativegearing'])),0,items('For_Each_Liabilities')?['vl_applicant2negativegearing'])"
                                    }
                                  }
                                },
                                "runAfter": {},
                                "expression": {
                                  "and": [
                                    {
                                      "equals": [
                                        "@items('For_Each_Applicants')?['vl_applicantid']",
                                        "@items('For_Each_Liabilities')?['_vl_applicant2id_value']"
                                      ]
                                    }
                                  ]
                                },
                                "metadata": {
                                  "operationMetadataId": "725c4e35-4641-4255-a2e4-876be58e29d0"
                                },
                                "type": "If"
                              }
                            }
                          },
                          "expression": {
                            "equals": [
                              "@items('For_Each_Liabilities')?['_vl_applicant1id_value']",
                              "@items('For_Each_Applicants')?['vl_applicantid']"
                            ]
                          },
                          "metadata": {
                            "operationMetadataId": "2f23037d-639a-4d71-a87f-502494cc6bbe"
                          },
                          "type": "If"
                        }
                      },
                      "runAfter": {
                        "Increment_varRepayment_With_Repayment_Credit_Adjustment": [
                          "Succeeded"
                        ]
                      },
                      "expression": {
                        "equals": [
                          "@items('For_Each_Liabilities')?['vl_negativelygeared']",
                          "@true"
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "dfc2bb89-bba7-48ca-b1c0-bbf013e6039c"
                      },
                      "type": "If"
                    }
                  },
                  "runAfter": {
                    "Get_Liabilities_Details": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "128d3f98-a63e-4e52-a873-9edc3f2ba46f"
                  },
                  "type": "Foreach"
                },
                "Reset_varEmploymentIncomeCreditAdjustment": {
                  "runAfter": {
                    "Reset_varGrossIncomeEligible": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "b30cc2a9-9784-490f-bcca-ac51e011c580"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varEmploymentIncomeCreditAdjustment",
                    "value": 0
                  }
                },
                "Reset_varDebtBalance": {
                  "runAfter": {
                    "Reset_varPAYGEmploymentIncomeCreditAdjustment": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "7e11e4e7-4cdd-40f2-a490-c37ffbfa2a65"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varDebtBalance",
                    "value": 0
                  }
                },
                "Reset_varDebtBalanceCreditAdjustment": {
                  "runAfter": {
                    "Reset_varDebtBalance": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "0ec831c4-8d7f-49d9-a1b8-b60de57c159e"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varDebtBalanceCreditAdjustment",
                    "value": 0
                  }
                },
                "Reset_varRepayment": {
                  "runAfter": {
                    "Reset_varDebtBalanceCreditAdjustment": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "3242f351-7f98-4c30-8407-e712b26c1a6c"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varRepayment",
                    "value": 0
                  }
                },
                "Reset_varNegativeGearing": {
                  "runAfter": {
                    "Reset_varRepayment": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "58b0b915-4ca5-4fde-a926-71408403370b"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varNegativeGearing",
                    "value": 0
                  }
                },
                "Reset_varTaxDeduction": {
                  "runAfter": {
                    "Reset_varNegativeGearing": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "b7e9250c-666b-42d4-ad7d-35a874a4f79d"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varTaxDeduction",
                    "value": 0
                  }
                },
                "Set_varGrossIncome": {
                  "runAfter": {
                    "For_Each_Employments": [
                      "Succeeded"
                    ],
                    "For_Each_Incomes": [
                      "Succeeded"
                    ],
                    "For_Each_Liabilities": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "885d5756-55f6-49db-b7da-45fe150b17c1"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varGrossIncome",
                    "value": "@add(add(add(add(add(add(add(add(add(add(add(add(variables('varPAYGIncome'), variables('varSelfEmployedIncome')), variables('varUnEmployedIncome')), variables('varAnnuities')), variables('varChildMaintanance')), variables('varDividends')), variables('varForeignSourced')), variables('varGovtBenefits')), variables('varInvestmentIncome')), variables('varOtherIncome')), variables('varRentalIncome')), variables('varWorkersCompensation')),variables('varEmploymentIncomeCreditAdjustment'))"
                  }
                },
                "Set_varGrossIncomeEligible": {
                  "runAfter": {
                    "Set_varGrossIncome": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "0d138703-d643-4613-8f0f-338be8b6ed09"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varGrossIncomeEligible",
                    "value": "@add(add(add(add(add(add(add(add(add(add(add(add(variables('varPAYGIncomeEligible'), variables('varSelfEmployedIncomeEligible')), variables('varUnEmployedIncomeEligible')), variables('varAnnuitiesEligible')), variables('varChildMaintananceEligible')), variables('varDividendsEligible')), variables('varForeignSourcedEligible')), variables('varGovtBenefitsEligible')), variables('varInvestmentIncomeEligible')), variables('varOtherIncomeEligible')), variables('varRentalIncomeEligible')), variables('varWorkersCompensationEligible')),variables('varEmploymentIncomeCreditAdjustment'))"
                  }
                },
                "Get_Employment_Details": {
                  "runAfter": {
                    "Check_Primary_Applicant": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "1f8d7e36-34c8-4933-aec2-2eddd337dc6c"
                  },
                  "type": "OpenApiConnection",
                  "inputs": {
                    "host": {
                      "connectionName": "shared_commondataserviceforapps",
                      "operationId": "ListRecords",
                      "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                    },
                    "parameters": {
                      "entityName": "vl_employments",
                      "$filter": "_vl_applicationid_value eq '@{triggerOutputs()?['body/_vl_applicationid_value']}' and vl_employmentcategory eq 127420000 and _vl_applicantid_value eq '@{items('For_Each_Applicants')?['vl_applicantid']}'"
                    },
                    "authentication": "@parameters('$authentication')"
                  }
                },
                "Get_Liabilities_Details": {
                  "runAfter": {
                    "Check_Primary_Applicant": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "044d3785-26a0-4b96-b9ce-5711d4db8a1b"
                  },
                  "type": "OpenApiConnection",
                  "inputs": {
                    "host": {
                      "connectionName": "shared_commondataserviceforapps",
                      "operationId": "ListRecords",
                      "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                    },
                    "parameters": {
                      "entityName": "vl_liabilitieses",
                      "$filter": "_vl_applicationid_value eq '@{triggerOutputs()?['body/_vl_applicationid_value']}' and \n _vl_applicant1id_value eq '@{items('For_Each_Applicants')?['vl_applicantid']}' or _vl_applicant2id_value eq '@{items('For_Each_Applicants')?['vl_applicantid']}' "
                    },
                    "authentication": "@parameters('$authentication')"
                  }
                },
                "Get_Income_Details": {
                  "runAfter": {
                    "Check_Primary_Applicant": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "e512213d-4b82-45ca-9b06-28dbc259b2ae"
                  },
                  "type": "OpenApiConnection",
                  "inputs": {
                    "host": {
                      "connectionName": "shared_commondataserviceforapps",
                      "operationId": "ListRecords",
                      "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                    },
                    "parameters": {
                      "entityName": "vl_incomes",
                      "$filter": "_vl_applicationid_value eq '@{triggerOutputs()?['body/_vl_applicationid_value']}' and _vl_applicantid_value eq '@{items('For_Each_Applicants')?['vl_applicantid']}'"
                    },
                    "authentication": "@parameters('$authentication')"
                  }
                },
                "Check_Single_Household_Type": {
                  "actions": {
                    "Set_varHouseHoldType_Couple": {
                      "runAfter": {},
                      "metadata": {
                        "operationMetadataId": "9a3874d2-3b09-465a-8d0a-f460d5434c24"
                      },
                      "type": "SetVariable",
                      "inputs": {
                        "name": "varHouseHoldType",
                        "value": "127420001"
                      }
                    }
                  },
                  "runAfter": {
                    "Set_varEmploymentCreditAdjustment": [
                      "Succeeded"
                    ]
                  },
                  "expression": {
                    "or": [
                      {
                        "greater": [
                          "@length(body('Get_Applicants_Details')?['value'])",
                          1
                        ]
                      },
                      {
                        "not": {
                          "equals": [
                            "@length(body('Filter_Marital_Status'))",
                            0
                          ]
                        }
                      }
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "0680ac6d-775a-4aff-a58e-25152f97caae"
                  },
                  "type": "If"
                },
                "Reset_varLivingExpense": {
                  "runAfter": {
                    "Reset_varTaxDeduction": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "284d343a-b23a-434d-baba-f63ce4154934"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varLivingExpense",
                    "value": 0
                  }
                },
                "Reset_varExpenseCreditAdjustment_": {
                  "runAfter": {
                    "Reset_varLivingExpense": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "ca69b757-4d8a-4ffe-9b33-237d8e09f46e"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varExpenseCreditAdjustment",
                    "value": 0
                  }
                },
                "Reset_varHEMExpense": {
                  "runAfter": {
                    "Reset_varExpenseCreditAdjustment_": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "1f2a1427-a440-43cb-86e8-6ace4d4e0527"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varHEMExpense",
                    "value": 0
                  }
                },
                "Reset_varTaxableIncome": {
                  "runAfter": {
                    "Reset_varHEMExpense": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "73eab178-cd40-4a3f-947c-ec04ef3802ec"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varTaxableIncome",
                    "value": 0
                  }
                },
                "Set_varTaxableincome_": {
                  "runAfter": {
                    "Set_varGrossIncomeEligible": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "3c5a6451-f4b6-4be7-b314-c7d84a59310f"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varTaxableIncome",
                    "value": "@sub(variables('varGrossIncomeEligible'),add(variables('varNegativeGearing'),variables('varTaxDeduction')))"
                  }
                },
                "Add_Applicant_Serviceability_Results": {
                  "runAfter": {
                    "Set_varNetAnnualIncome": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "498f50c2-1249-41a1-8314-12517e4e4f11"
                  },
                  "type": "OpenApiConnection",
                  "inputs": {
                    "host": {
                      "connectionName": "shared_commondataserviceforapps",
                      "operationId": "CreateRecord",
                      "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                    },
                    "parameters": {
                      "entityName": "vl_serviceabilities",
                      "item/vl_annuities": "@variables('varAnnuitiesEligible')",
                      "item/vl_ApplicantID@odata.bind": "/vl_applicants(@{items('For_Each_Applicants')?['vl_applicantid']})",
                      "item/vl_ApplicationID@odata.bind": "/vl_applicationses(@{outputs('Get_Application_Details')?['body/vl_applicationsid']})",
                      "item/vl_childmaintenace": "@variables('varChildMaintananceEligible')",
                      "item/vl_creditadjustmentapplied": "@variables('varEmploymentIncomeCreditAdjustment')",
                      "item/vl_dividends": "@variables('varDividendsEligible')",
                      "item/vl_foreignsourced": "@variables('varForeignSourcedEligible')",
                      "item/vl_governmentbenefits": "@variables('varGovtBenefitsEligible')",
                      "item/vl_grosseligibleincome": "@variables('varGrossIncomeEligible')",
                      "item/vl_grossincome": "@variables('varGrossIncome')",
                      "item/vl_incometax": "@variables('varTotalTax')",
                      "item/vl_investmentincome": "@variables('varInvestmentIncomeEligible')",
                      "item/vl_livingexpense": "@variables('varLivingExpense')",
                      "item/vl_livingexpensecreditadjustment": "@variables('varExpenseCreditAdjustment')",
                      "item/vl_loanamount": "@outputs('Get_Application_Details')?['body/vl_requiredloanamount']",
                      "item/vl_medicarelevy": "@variables('varMedicareLevy')",
                      "item/vl_negativegearing": "@variables('varNegativeGearing')",
                      "item/vl_netannualincome": "@variables('varNetAnnualIncome')",
                      "item/vl_numberofapplicants": "@length(body('Get_Applicants_Details')?['value'])",
                      "item/vl_otherincome": "@variables('varOtherIncomeEligible')",
                      "item/vl_paygincome": "@variables('varPAYGIncomeEligible')",
                      "item/vl_rentalincome": "@variables('varRentalIncomeEligible')",
                      "item/vl_selfemployedincome": "@variables('varSelfEmployedIncomeEligible')",
                      "item/vl_serviceabilityresulttype": 127420001,
                      "item/vl_serviceabilitystatus": true,
                      "item/vl_taxdeduction": "@variables('varTaxDeduction')",
                      "item/vl_taxableincome": "@variables('varTaxableIncome')",
                      "item/vl_unemployedincome": "@variables('varUnEmployedIncomeEligible')",
                      "item/vl_workerscompensation": "@variables('varWorkersCompensationEligible')"
                    },
                    "authentication": "@parameters('$authentication')"
                  }
                },
                "Check_Primary_Applicant": {
                  "actions": {
                    "Set_varPrimaryApplicantID": {
                      "runAfter": {},
                      "metadata": {
                        "operationMetadataId": "ee467a6a-e0b1-46c7-8623-aeb13e7f5c82"
                      },
                      "type": "SetVariable",
                      "inputs": {
                        "name": "varPrimaryApplicantID",
                        "value": "@items('For_Each_Applicants')?['vl_applicantid']"
                      }
                    },
                    "Set_varPrimaryApplicantDependants": {
                      "runAfter": {
                        "Set_varPrimaryApplicantID": [
                          "Succeeded"
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "4f2fb450-c9aa-4fbd-8d9c-0c06df29671b"
                      },
                      "type": "SetVariable",
                      "inputs": {
                        "name": "varPrimaryApplicantDependants",
                        "value": "@items('For_Each_Applicants')?['vl_noofdependents']"
                      }
                    }
                  },
                  "runAfter": {
                    "Increment_varDependants": [
                      "Succeeded"
                    ]
                  },
                  "expression": {
                    "and": [
                      {
                        "equals": [
                          "@items('For_Each_Applicants')?['vl_primaryapplicant']",
                          "@true"
                        ]
                      }
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "fcebbb28-c81e-4859-b3df-19dd94ec4519"
                  },
                  "type": "If"
                },
                "Reset_varTaxRate": {
                  "runAfter": {
                    "Reset_varTaxableIncome": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "2e2ffeb6-56e9-4f73-abb6-50276ddfaca8"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varTaxRate",
                    "value": 0
                  }
                },
                "Reset_varMedicareLevy": {
                  "runAfter": {
                    "Reset_varTaxRate": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "ae868484-289b-455f-a6e4-fb604f157aef"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varMedicareLevy",
                    "value": 0
                  }
                },
                "Reset_varTaxBracketMinimum": {
                  "runAfter": {
                    "Reset_varMedicareLevy": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "96c238ba-c22c-41a7-921a-6928a05e2c5a"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varTaxBracketMinimum",
                    "value": 0
                  }
                },
                "Reset_varTaxBracketMaximum": {
                  "runAfter": {
                    "Reset_varTaxBracketMinimum": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "75ecbead-75b5-495c-83cc-005447a11dc8"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varTaxBracketMaximum",
                    "value": 0
                  }
                },
                "Reset_varMinimumTax": {
                  "runAfter": {
                    "Reset_varTaxBracketMaximum": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "c2aed7da-048e-4040-8b29-0dc0c9c66bee"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varMinimumTax",
                    "value": 0
                  }
                },
                "Reset_varTotalTax": {
                  "runAfter": {
                    "Reset_varMinimumTax": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "6942a5dd-9e29-4e44-b47d-64a98306b1d2"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varTotalTax",
                    "value": 0
                  }
                },
                "Reset_varPreviousTaxBracketMaximum": {
                  "runAfter": {
                    "Reset_varTotalTax": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "21510059-d9c0-4038-9f8d-7e43352689ec"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varPreviousTaxBracketMaximum",
                    "value": 0
                  }
                },
                "For_Each_Tax_Bracket": {
                  "foreach": "@outputs('Get_Tax_Brackets')?['body/value']",
                  "actions": {
                    "Switch_Tax_Type": {
                      "runAfter": {},
                      "cases": {
                        "Medicare_Levy": {
                          "case": 127420001,
                          "actions": {
                            "Set_varTaxRate": {
                              "runAfter": {},
                              "metadata": {
                                "operationMetadataId": "24b8fa42-38ef-4ab2-9429-70e2f62318ef"
                              },
                              "type": "SetVariable",
                              "inputs": {
                                "name": "varTaxRate",
                                "value": "@items('For_Each_Tax_Bracket')?['vl_taxrate']"
                              }
                            },
                            "Set_varMedicareLevy": {
                              "runAfter": {
                                "Set_varTaxRate": [
                                  "Succeeded"
                                ]
                              },
                              "metadata": {
                                "operationMetadataId": "33daeec1-24c7-4fd0-8bcd-1e3cd68ca14d"
                              },
                              "type": "SetVariable",
                              "inputs": {
                                "name": "varMedicareLevy",
                                "value": "@mul(variables('varTaxableIncome'),div(variables('varTaxRate'),100))"
                              }
                            }
                          }
                        },
                        "Tax_Bracket": {
                          "case": 127420000,
                          "actions": {
                            "Set_varTaxRate_Tax_Bracket": {
                              "runAfter": {},
                              "metadata": {
                                "operationMetadataId": "1221cbd2-2832-4733-a26a-89b63a5538a2"
                              },
                              "type": "SetVariable",
                              "inputs": {
                                "name": "varTaxRate",
                                "value": "@if(empty(string(items('For_Each_Tax_Bracket')?['vl_taxrate'])),0,items('For_Each_Tax_Bracket')?['vl_taxrate'])"
                              }
                            },
                            "Set_varTaxBracketMinimum": {
                              "runAfter": {
                                "Set_varTaxRate_Tax_Bracket": [
                                  "Succeeded"
                                ]
                              },
                              "metadata": {
                                "operationMetadataId": "7c029434-ac47-4d7e-8da4-1d92342395b0"
                              },
                              "type": "SetVariable",
                              "inputs": {
                                "name": "varTaxBracketMinimum",
                                "value": "@if(empty(string(items('For_Each_Tax_Bracket')?['vl_taxbracketminimum'])),0,items('For_Each_Tax_Bracket')?['vl_taxbracketminimum'])"
                              }
                            },
                            "Set_varTaxBracketMaximum": {
                              "runAfter": {
                                "Set_varTaxBracketMinimum": [
                                  "Succeeded"
                                ]
                              },
                              "metadata": {
                                "operationMetadataId": "c25c32e0-166c-424a-b954-adbf723ded48"
                              },
                              "type": "SetVariable",
                              "inputs": {
                                "name": "varTaxBracketMaximum",
                                "value": "@if(empty(string(items('For_Each_Tax_Bracket')?['vl_taxbracketmaximum'])),0,items('For_Each_Tax_Bracket')?['vl_taxbracketmaximum'])"
                              }
                            },
                            "Set_varMinimumTax": {
                              "runAfter": {
                                "Set_varTaxBracketMaximum": [
                                  "Succeeded"
                                ]
                              },
                              "metadata": {
                                "operationMetadataId": "5a983552-26e6-417b-b07d-69d763f23b04"
                              },
                              "type": "SetVariable",
                              "inputs": {
                                "name": "varMinimumTax",
                                "value": "@if(empty(string(items('For_Each_Tax_Bracket')?['vl_minimumtaxpayable'])),0,items('For_Each_Tax_Bracket')?['vl_minimumtaxpayable'])"
                              }
                            },
                            "Check_Income_Tax_Bracket": {
                              "actions": {
                                "Increment_varTotalTax_Inside_Tax_Bracket": {
                                  "runAfter": {},
                                  "metadata": {
                                    "operationMetadataId": "77f7ac4e-e755-49ea-a0d8-e87901952ba8"
                                  },
                                  "type": "IncrementVariable",
                                  "inputs": {
                                    "name": "varTotalTax",
                                    "value": "@add(variables('varMinimumTax'), mul(sub(variables('varTaxableIncome'),sub(variables('varTaxBracketMinimum'),1)),div(variables('varTaxRate'),100)))"
                                  }
                                }
                              },
                              "runAfter": {
                                "Set_varMinimumTax": [
                                  "Succeeded"
                                ]
                              },
                              "else": {
                                "actions": {
                                  "Compare_Taxable_Income_with_Tax_Bracket_Maximum_and_Previous": {
                                    "actions": {
                                      "Compare_Taxable_Income_and_Tax_Bracket_Maximum": {
                                        "actions": {
                                          "Increment_varTotalTax_With_Minimum_Tax": {
                                            "runAfter": {},
                                            "metadata": {
                                              "operationMetadataId": "92490fa4-dc05-4bbd-a2f5-22f921342124"
                                            },
                                            "type": "IncrementVariable",
                                            "inputs": {
                                              "name": "varTotalTax",
                                              "value": "@variables('varMinimumTax')"
                                            }
                                          }
                                        },
                                        "runAfter": {},
                                        "else": {
                                          "actions": {
                                            "Increment_variable_2": {
                                              "runAfter": {},
                                              "metadata": {
                                                "operationMetadataId": "0fa5b55e-c7d7-4ad7-9435-0d70effd0f0e"
                                              },
                                              "type": "IncrementVariable",
                                              "inputs": {
                                                "name": "varTotalTax",
                                                "value": "@mul(div(sub(variables('varTaxableIncome'),variables('varTaxBracketMinimum')),100),variables('varTaxRate'))"
                                              }
                                            }
                                          }
                                        },
                                        "expression": {
                                          "and": [
                                            {
                                              "greater": [
                                                "@variables('varTaxableIncome')",
                                                "@variables('varTaxBracketMaximum')"
                                              ]
                                            }
                                          ]
                                        },
                                        "metadata": {
                                          "operationMetadataId": "bd58daba-e044-4d85-864e-b6e0471bcb1f"
                                        },
                                        "type": "If"
                                      }
                                    },
                                    "runAfter": {},
                                    "else": {
                                      "actions": {
                                        "Check_Tax_Bracket_Not_Found": {
                                          "actions": {
                                            "Increment_varTotalTax_Tax_Bracket_Not_Found": {
                                              "runAfter": {},
                                              "metadata": {
                                                "operationMetadataId": "e4805715-cfd4-4bfd-b35d-ac6e809bbe48"
                                              },
                                              "type": "IncrementVariable",
                                              "inputs": {
                                                "name": "varTotalTax",
                                                "value": "@mul(div(sub(variables('varTaxableIncome'),190000),100),variables('varTaxRate'))"
                                              }
                                            }
                                          },
                                          "runAfter": {},
                                          "expression": {
                                            "and": [
                                              {
                                                "greater": [
                                                  "@variables('varTaxableIncome')",
                                                  190000
                                                ]
                                              },
                                              {
                                                "greater": [
                                                  "@variables('varTaxBracketMinimum')",
                                                  190000
                                                ]
                                              }
                                            ]
                                          },
                                          "metadata": {
                                            "operationMetadataId": "f12b25c1-2256-47b7-a9e1-e6d663ce0820"
                                          },
                                          "type": "If"
                                        }
                                      }
                                    },
                                    "expression": {
                                      "or": [
                                        {
                                          "greaterOrEquals": [
                                            "@variables('varTaxableIncome')",
                                            "@variables('varTaxBracketMaximum')"
                                          ]
                                        },
                                        {
                                          "greaterOrEquals": [
                                            "@variables('varTaxableIncome')",
                                            "@variables('varPreviousTaxBracketMaximum')"
                                          ]
                                        }
                                      ]
                                    },
                                    "metadata": {
                                      "operationMetadataId": "25678e4c-e318-4335-a197-ef5a4e65b0b0"
                                    },
                                    "type": "If"
                                  }
                                }
                              },
                              "expression": {
                                "and": [
                                  {
                                    "lessOrEquals": [
                                      "@variables('varTaxableIncome')",
                                      "@variables('varTaxBracketMaximum')"
                                    ]
                                  },
                                  {
                                    "greaterOrEquals": [
                                      "@variables('varTaxableIncome')",
                                      "@variables('varTaxBracketMinimum')"
                                    ]
                                  },
                                  {
                                    "equals": [
                                      "@items('For_Each_Tax_Bracket')?['vl_taxtype']",
                                      127420001
                                    ]
                                  }
                                ]
                              },
                              "metadata": {
                                "operationMetadataId": "9fbffc58-7ddc-4da6-ac42-97cce40261b2"
                              },
                              "type": "If"
                            },
                            "Set_varPreviousTaxBracketMaximum": {
                              "runAfter": {
                                "Check_Income_Tax_Bracket": [
                                  "Succeeded"
                                ]
                              },
                              "metadata": {
                                "operationMetadataId": "ecc6ec26-57dc-427a-8e0a-a8a6464bce72"
                              },
                              "type": "SetVariable",
                              "inputs": {
                                "name": "varPreviousTaxBracketMaximum",
                                "value": "@if(empty(string(items('For_Each_Tax_Bracket')?['vl_taxbracketmaximum'])),0,items('For_Each_Tax_Bracket')?['vl_taxbracketmaximum'])"
                              }
                            }
                          }
                        }
                      },
                      "default": {
                        "actions": {}
                      },
                      "expression": "@items('For_Each_Tax_Bracket')?['vl_taxtype']",
                      "metadata": {
                        "operationMetadataId": "2cae9657-99fc-4ca9-9c2f-f81cf9d71344"
                      },
                      "type": "Switch"
                    }
                  },
                  "runAfter": {
                    "For_Each_Single_Expense": [
                      "Succeeded",
                      "Failed",
                      "Skipped",
                      "TimedOut"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "61b0cd94-168b-4ce5-aad5-b0b9aa3067d0"
                  },
                  "type": "Foreach"
                },
                "Reset_varNetAnnualIncome": {
                  "runAfter": {
                    "Reset_varPreviousTaxBracketMaximum": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "1c43b254-1fad-427e-a3f6-49e7909a82c9"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varNetAnnualIncome",
                    "value": 0
                  }
                },
                "Set_varNetAnnualIncome": {
                  "runAfter": {
                    "For_Each_Tax_Bracket": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "6fcdd547-7b11-48b5-8471-3f2fe3471c7b"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varNetAnnualIncome",
                    "value": "@sub(variables('varGrossIncomeEligible'),add(variables('varMedicareLevy'),variables('varTotalTax')))"
                  }
                },
                "Increment_varDependants": {
                  "runAfter": {
                    "Reset_varNetAnnualIncome": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "d66b4fcc-1d99-4a64-9971-59ffeaeb1e89"
                  },
                  "type": "IncrementVariable",
                  "inputs": {
                    "name": "varDependants",
                    "value": "@if(empty(string(item()?['vl_noofdependents'])),0,item()?['vl_noofdependents'])"
                  }
                },
                "Reset_varPAYGEmploymentIncomeCreditAdjustment": {
                  "runAfter": {
                    "Reset_varEmploymentIncomeCreditAdjustment": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "5f2856d3-56b8-4235-b2c5-3447fc72c9c5"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varPAYGEmploymentIncomeCreditAdjustment",
                    "value": 0
                  }
                },
                "Set_varEmploymentCreditAdjustment": {
                  "runAfter": {
                    "Add_All_Employment_Credit_Adjustment": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "2dd768d0-f07e-4a8b-89ea-09af3b593332"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varEmploymentIncomeCreditAdjustment",
                    "value": "@outputs('Add_All_Employment_Credit_Adjustment')"
                  }
                },
                "Add_All_Employment_Credit_Adjustment": {
                  "runAfter": {
                    "Set_varTaxableincome_": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "d72ae0a4-e29c-4c68-a372-ab3bb1add9fb"
                  },
                  "type": "Compose",
                  "inputs": "@add(variables('varPAYGEmploymentIncomeCreditAdjustment'),variables('varEmploymentIncomeCreditAdjustment'))"
                },
                "For_Each_Single_Expense": {
                  "foreach": "@outputs('Get_Single_Expense_Details')?['body/value']",
                  "actions": {
                    "Get_Expense_Results": {
                      "runAfter": {},
                      "metadata": {
                        "operationMetadataId": "d2ca75ad-c29e-4a3c-abdc-60176ca0b2ba"
                      },
                      "type": "OpenApiConnection",
                      "inputs": {
                        "host": {
                          "connectionName": "shared_commondataserviceforapps",
                          "operationId": "ListRecords",
                          "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                        },
                        "parameters": {
                          "entityName": "vl_expenseresultses",
                          "$filter": "_vl_expenseprimaryid_value eq '@{items('For_Each_Single_Expense')?['vl_expenseid']}'"
                        },
                        "authentication": "@parameters('$authentication')"
                      }
                    },
                    "Increment_varLivingExpense": {
                      "runAfter": {
                        "Get_Expense_Results": [
                          "Succeeded"
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "1c42c73f-3ead-41bf-8f44-c2f532b2fef0"
                      },
                      "type": "IncrementVariable",
                      "inputs": {
                        "name": "varLivingExpense",
                        "value": "@if(empty(string(first(body('Get_Expense_Results')?['value'])?['vl_totalmonthlylivingexpense'])),0,first(body('Get_Expense_Results')?['value'])?['vl_totalmonthlylivingexpense'])"
                      }
                    },
                    "Increment_varExpenseCreditAdjustment": {
                      "runAfter": {
                        "Increment_varLivingExpense": [
                          "Succeeded"
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "1c8740c5-f41e-4d83-8d1e-a83acabd7db3"
                      },
                      "type": "IncrementVariable",
                      "inputs": {
                        "name": "varExpenseCreditAdjustment",
                        "value": "@if(empty(string(items('For_Each_Single_Expense')?['vl_creditadjustment'])),0,items('For_Each_Single_Expense')?['vl_creditadjustment'])"
                      }
                    },
                    "Get_HEM_Details": {
                      "runAfter": {
                        "Increment_varExpenseCreditAdjustment": [
                          "Succeeded"
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "0ff1a49a-2b76-4bd7-a343-5924f9559d45"
                      },
                      "type": "OpenApiConnection",
                      "inputs": {
                        "host": {
                          "connectionName": "shared_commondataserviceforapps",
                          "operationId": "ListRecords",
                          "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                        },
                        "parameters": {
                          "entityName": "vl_hems",
                          "$filter": "vl_hemhousehold eq 127420000 and vl_hemincomeminimum le @{variables('varGrossIncome')} and vl_hemincomemaximum ge @{variables('varGrossIncome')}"
                        },
                        "authentication": "@parameters('$authentication')"
                      }
                    },
                    "Set_varHEMExpense_Single": {
                      "runAfter": {
                        "Get_HEM_Details": [
                          "Succeeded"
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "bd98e4f2-d15e-429a-b0a0-7f0b7612fe99"
                      },
                      "type": "SetVariable",
                      "inputs": {
                        "name": "varHEMExpense",
                        "value": "@if(equals(items('For_Each_Applicants')?['vl_noofdependents'],0),first(body('Get_HEM_Details')?['value'])?['vl_hemexpense0dependant'],if(equals(items('For_Each_Applicants')?['vl_noofdependents'],1),first(body('Get_HEM_Details')?['value'])?['vl_hemexpense1dependant'],if(equals(items('For_Each_Applicants')?['vl_noofdependents'],2),first(body('Get_HEM_Details')?['value'])?['vl_hemexpense2dependant'],if(equals(items('For_Each_Applicants')?['vl_noofdependents'],3),first(body('Get_HEM_Details')?['value'])?['vl_hemexpense3dependant'],if(equals(items('For_Each_Applicants')?['vl_noofdependents'],4),first(body('Get_HEM_Details')?['value'])?['vl_hemexpense4dependant'],if(equals(items('For_Each_Applicants')?['vl_noofdependents'],5),first(body('Get_HEM_Details')?['value'])?['vl_hemexpense5dependant'],if(greater(items('For_Each_Applicants')?['vl_noofdependents'],5),mul(items('For_Each_Applicants')?['vl_noofdependents'],first(body('Get_HEM_Details')?['value'])?['vl_hemexpenseperdependant']),0)))))))"
                      }
                    },
                    "Update_Serviceability_HEM_Single": {
                      "runAfter": {
                        "Set_varHEMExpense_Single": [
                          "Succeeded"
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "9bc1bf76-f7f4-4451-b062-6880901a71bc"
                      },
                      "type": "OpenApiConnection",
                      "inputs": {
                        "host": {
                          "connectionName": "shared_commondataserviceforapps",
                          "operationId": "UpdateOnlyRecord",
                          "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                        },
                        "parameters": {
                          "entityName": "vl_expenseresultses",
                          "recordId": "@first(body('Get_Expense_Results')?['value'])?['vl_expenseresultsid']",
                          "item/vl_hem": "@div(mul(variables('varHEMExpense'),52),12)"
                        },
                        "authentication": "@parameters('$authentication')"
                      }
                    }
                  },
                  "runAfter": {
                    "Get_Single_Expense_Details": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "2a3e43bd-9292-4496-bf58-853f38fba62a"
                  },
                  "type": "Foreach"
                },
                "Get_Single_Expense_Details": {
                  "runAfter": {
                    "Check_Single_Household_Type": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "32d411eb-a608-4bda-95b5-b297ece9e9fb"
                  },
                  "type": "OpenApiConnection",
                  "inputs": {
                    "host": {
                      "connectionName": "shared_commondataserviceforapps",
                      "operationId": "ListRecords",
                      "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                    },
                    "parameters": {
                      "entityName": "vl_expenses",
                      "$filter": "_vl_applicationid_value eq '@{triggerOutputs()?['body/_vl_applicationid_value']}' and _vl_applicantid_value eq '@{items('For_Each_Applicants')?['vl_applicantid']}'"
                    },
                    "authentication": "@parameters('$authentication')"
                  }
                },
                "Check_Loan_Purpose_Purchase": {
                  "actions": {
                    "Get_Investment_Asset_Details": {
                      "runAfter": {},
                      "metadata": {
                        "operationMetadataId": "efc4c0a7-539b-40fa-917a-314e59ea27e5"
                      },
                      "type": "OpenApiConnection",
                      "inputs": {
                        "host": {
                          "connectionName": "shared_commondataserviceforapps",
                          "operationId": "ListRecords",
                          "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                        },
                        "parameters": {
                          "entityName": "vl_assetses",
                          "$filter": "_vl_applicationid_value eq '@{triggerOutputs()?['body/_vl_applicationid_value']}' and _vl_applicantid_value eq '@{items('For_Each_Applicants')?['vl_applicantid']}' and vl_occupancy eq 127420001"
                        },
                        "authentication": "@parameters('$authentication')"
                      }
                    },
                    "Increment_varNegativeGearing_Investment": {
                      "runAfter": {
                        "Get_Investment_Asset_Details": [
                          "Succeeded"
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "aa93964f-5481-4047-9855-bae95208e582"
                      },
                      "type": "IncrementVariable",
                      "inputs": {
                        "name": "varNegativeGearing",
                        "value": "@if(not(equals(length(body('Get_Investment_Asset_Details')?['value']),0)),first(body('Get_Investment_Asset_Details')?['value'])?['vl_negativegearing'],0)"
                      }
                    }
                  },
                  "runAfter": {
                    "Check_Primary_Applicant": [
                      "Succeeded"
                    ]
                  },
                  "expression": {
                    "equals": [
                      "@outputs('Get_Application_Details')?['body/vl_primaryloanpurpose']",
                      127420000
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "fade4632-41eb-47d4-aeb0-b5a877b12881"
                  },
                  "type": "If"
                }
              },
              "runAfter": {
                "For_Each_Serviceability_Results": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "46a9e79d-d70d-4d33-9e35-a8b7676841d3"
              },
              "type": "Foreach"
            },
            "Filter_Marital_Status": {
              "runAfter": {
                "Get_Applicants_Details": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "e486d816-b9f7-4842-add5-4f7f1ca0dbb4"
              },
              "type": "Query",
              "inputs": {
                "from": "@outputs('Get_Applicants_Details')?['body/value']",
                "where": "@equals(item()?['vl_maritalstatus'], 127420001)"
              }
            },
            "Application_Sericeability_Calculation": {
              "actions": {
                "Reset_varPAYGIncomeEligible_2": {
                  "runAfter": {},
                  "metadata": {
                    "operationMetadataId": "543262ba-cb53-4570-b530-2dd7c67c2f98"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varPAYGIncomeEligible",
                    "value": 0
                  }
                },
                "Reset_varSelfEmployedIncomeEligible_2": {
                  "runAfter": {
                    "Reset_varPAYGIncomeEligible_2": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "cce1a6fe-477e-452f-aae0-4e4ca8fd7fda"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varSelfEmployedIncomeEligible",
                    "value": 0
                  }
                },
                "Reset_varUnEmployedIncomeEligible_2": {
                  "runAfter": {
                    "Reset_varSelfEmployedIncomeEligible_2": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "92d4c2a5-f103-4337-8957-79824c0386b7"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varUnEmployedIncomeEligible",
                    "value": 0
                  }
                },
                "Reset_varAnnuitiesEligible_2": {
                  "runAfter": {
                    "Reset_varUnEmployedIncomeEligible_2": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "88c8f91e-5b48-4aab-8c58-540bc16787f2"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varAnnuitiesEligible",
                    "value": 0
                  }
                },
                "Reset_varChildMaintananceEligible_2": {
                  "runAfter": {
                    "Reset_varAnnuitiesEligible_2": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "bae16509-7a49-405a-a78e-12b80d926360"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varChildMaintananceEligible",
                    "value": 0
                  }
                },
                "Reset_varDividendsEligible_2": {
                  "runAfter": {
                    "Reset_varChildMaintananceEligible_2": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "a1dcd1ee-e5f1-4b0c-8274-f55fa13fb684"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varDividendsEligible",
                    "value": 0
                  }
                },
                "Reset_varForeignSourcedEligible_2": {
                  "runAfter": {
                    "Reset_varDividendsEligible_2": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "bb21d78c-63ee-481c-acf4-af42fff9673d"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varForeignSourcedEligible",
                    "value": 0
                  }
                },
                "Reset_varGovtBenefitsEligible_2": {
                  "runAfter": {
                    "Reset_varForeignSourcedEligible_2": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "21658152-9193-4397-b9f7-ed1af67705ff"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varGovtBenefitsEligible",
                    "value": 0
                  }
                },
                "Reset_varInvestmentIncomeEligible_2": {
                  "runAfter": {
                    "Reset_varGovtBenefitsEligible_2": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "83ab2669-e458-424e-ba35-3275615e4d68"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varInvestmentIncomeEligible",
                    "value": 0
                  }
                },
                "Reset_varOtherIncomeEligible_2": {
                  "runAfter": {
                    "Reset_varInvestmentIncomeEligible_2": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "afae5787-0d21-4e66-914f-7cbc15437c3d"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varOtherIncomeEligible",
                    "value": 0
                  }
                },
                "Rest_varRentalIncomeEligible_2": {
                  "runAfter": {
                    "Reset_varOtherIncomeEligible_2": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "8b429258-6c81-440a-96e4-18422bb31ab2"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varRentalIncomeEligible",
                    "value": 0
                  }
                },
                "Reset_varWorkersCompensationEligible_2": {
                  "runAfter": {
                    "Rest_varRentalIncomeEligible_2": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "9df45532-28ed-4dd9-93fe-f5add94c2202"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varWorkersCompensationEligible",
                    "value": 0
                  }
                },
                "Reset_varGrossIncomeEligible_2": {
                  "runAfter": {
                    "Reset_varWorkersCompensationEligible_2": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "32a5c648-2229-4c6a-95e6-66cf3c694625"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varGrossIncomeEligible",
                    "value": 0
                  }
                },
                "Reset_varEmploymentIncomeCreditAdjustment_2": {
                  "runAfter": {
                    "Reset_varGrossIncome_2": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "b30cc2a9-9784-490f-bcca-ac51e011c580"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varEmploymentIncomeCreditAdjustment",
                    "value": 0
                  }
                },
                "Reset_varNegativeGearing_2": {
                  "runAfter": {
                    "Reset_varEmploymentIncomeCreditAdjustment_2": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "58b0b915-4ca5-4fde-a926-71408403370b"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varNegativeGearing",
                    "value": 0
                  }
                },
                "Reset_varTaxDeduction_2": {
                  "runAfter": {
                    "Reset_varNegativeGearing_2": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "b7e9250c-666b-42d4-ad7d-35a874a4f79d"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varTaxDeduction",
                    "value": 0
                  }
                },
                "Reset_varLivingExpense_2": {
                  "runAfter": {
                    "Reset_varTaxDeduction_2": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "a73fdf51-9498-47a8-8f4d-5e028255a63c"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varLivingExpense",
                    "value": 0
                  }
                },
                "Reset_varExpenseCreditAdjustment_2": {
                  "runAfter": {
                    "Reset_varLivingExpense_2": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "c570a718-73dd-413a-803b-00c2a0c2fd47"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varExpenseCreditAdjustment",
                    "value": 0
                  }
                },
                "Reset_varHEMExpense_2": {
                  "runAfter": {
                    "Reset_varExpenseCreditAdjustment_2": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "cc14abfa-0e56-42b8-8bfc-70b23a543abf"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varHEMExpense",
                    "value": 0
                  }
                },
                "Reset_varTaxableIncome_2": {
                  "runAfter": {
                    "Reset_varHEMExpense_2": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "8a8e0b30-1786-42a9-aac7-e6dc9a124b46"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varTaxableIncome",
                    "value": 0
                  }
                },
                "Get_Applicant_Serviceability_Details": {
                  "runAfter": {
                    "Reset_varNetAnnualIncome_2": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "0cb8212a-1db4-49a0-9f55-513f41ff5171"
                  },
                  "type": "OpenApiConnection",
                  "inputs": {
                    "host": {
                      "connectionName": "shared_commondataserviceforapps",
                      "operationId": "ListRecords",
                      "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                    },
                    "parameters": {
                      "entityName": "vl_serviceabilities",
                      "$filter": "_vl_applicationid_value eq '@{outputs('Get_Application_Details')?['body/vl_applicationsid']}' and vl_serviceabilitystatus eq true"
                    },
                    "authentication": "@parameters('$authentication')"
                  }
                },
                "For_Each_Applicant_Serviceability": {
                  "foreach": "@outputs('Get_Applicant_Serviceability_Details')?['body/value']",
                  "actions": {
                    "Increment_varPAYGIncomeEligible_Application": {
                      "runAfter": {},
                      "metadata": {
                        "operationMetadataId": "af9db8f4-3ea5-4091-b413-1c088197f453"
                      },
                      "type": "IncrementVariable",
                      "inputs": {
                        "name": "varPAYGIncomeEligible",
                        "value": "@if(empty(string(item()?['vl_paygincome'])),0,item()?['vl_paygincome'])"
                      }
                    },
                    "Increment_varSelfEmployedIncomeEligible_Application": {
                      "runAfter": {
                        "Increment_varPAYGIncomeEligible_Application": [
                          "Succeeded"
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "9ede7a90-19ff-45b1-bf69-bb1d11b60027"
                      },
                      "type": "IncrementVariable",
                      "inputs": {
                        "name": "varSelfEmployedIncomeEligible",
                        "value": "@if(empty(string(item()?['vl_selfemployedincome'])),0,item()?['vl_selfemployedincome'])"
                      }
                    },
                    "Increment_varUnEmployedIncomeEligible_Application": {
                      "runAfter": {
                        "Increment_varSelfEmployedIncomeEligible_Application": [
                          "Succeeded"
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "00afeee1-ce48-463c-b1ec-4ce84ed90333"
                      },
                      "type": "IncrementVariable",
                      "inputs": {
                        "name": "varUnEmployedIncomeEligible",
                        "value": "@if(empty(string(item()?['vl_unemployedincome'])),0,item()?['vl_unemployedincome'])"
                      }
                    },
                    "Increment_varAnnuitiesEligible_Application": {
                      "runAfter": {
                        "Increment_varUnEmployedIncomeEligible_Application": [
                          "Succeeded"
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "88d996e8-4510-4186-a2df-c90f08323158"
                      },
                      "type": "IncrementVariable",
                      "inputs": {
                        "name": "varAnnuitiesEligible",
                        "value": "@if(empty(string(item()?['vl_annuities'])),0,item()?['vl_annuities'])"
                      }
                    },
                    "Increment_varChildMaintananceEligible_Application": {
                      "runAfter": {
                        "Increment_varAnnuitiesEligible_Application": [
                          "Succeeded"
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "1bda1e20-8e4e-482d-a967-41bd2ef18701"
                      },
                      "type": "IncrementVariable",
                      "inputs": {
                        "name": "varChildMaintananceEligible",
                        "value": "@if(empty(string(item()?['vl_childmaintenace'])),0,item()?['vl_childmaintenace'])"
                      }
                    },
                    "Increment_varDividendsEligible_Application": {
                      "runAfter": {
                        "Increment_varChildMaintananceEligible_Application": [
                          "Succeeded"
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "3e40236d-0a2d-4d0e-8918-09431140a9cb"
                      },
                      "type": "IncrementVariable",
                      "inputs": {
                        "name": "varDividendsEligible",
                        "value": "@if(empty(string(item()?['vl_dividends'])),0,item()?['vl_dividends'])"
                      }
                    },
                    "Increment_varForeignSourcedEligible_Application": {
                      "runAfter": {
                        "Increment_varDividendsEligible_Application": [
                          "Succeeded"
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "d905494d-f983-48d7-8ba3-dea13e3a263c"
                      },
                      "type": "IncrementVariable",
                      "inputs": {
                        "name": "varForeignSourcedEligible",
                        "value": "@if(empty(string(item()?['vl_foreignsourced'])),0,item()?['vl_foreignsourced'])"
                      }
                    },
                    "Increment_varGovtBenefitsEligible_Application": {
                      "runAfter": {
                        "Increment_varForeignSourcedEligible_Application": [
                          "Succeeded"
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "a28ad87d-2238-4910-8e78-4ad25b8256d1"
                      },
                      "type": "IncrementVariable",
                      "inputs": {
                        "name": "varGovtBenefitsEligible",
                        "value": "@if(empty(string(item()?['vl_governmentbenefits'])),0,item()?['vl_governmentbenefits'])"
                      }
                    },
                    "Increment_varInvestmentIncomeEligible_Application": {
                      "runAfter": {
                        "Increment_varGovtBenefitsEligible_Application": [
                          "Succeeded"
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "5e6085b2-0afe-4e28-9b85-7990e8fbcd13"
                      },
                      "type": "IncrementVariable",
                      "inputs": {
                        "name": "varInvestmentIncomeEligible",
                        "value": "@if(empty(string(item()?['vl_investmentincome'])),0,item()?['vl_investmentincome'])"
                      }
                    },
                    "Increment_varOtherIncomeEligible_Application": {
                      "runAfter": {
                        "Increment_varInvestmentIncomeEligible_Application": [
                          "Succeeded"
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "81d861b1-ce0f-40ad-be95-ab1e50e7626e"
                      },
                      "type": "IncrementVariable",
                      "inputs": {
                        "name": "varOtherIncomeEligible",
                        "value": "@if(empty(string(item()?['vl_otherincome'])),0,item()?['vl_otherincome'])"
                      }
                    },
                    "Increment_varRentalIncomeEligible_Application": {
                      "runAfter": {
                        "Increment_varOtherIncomeEligible_Application": [
                          "Succeeded"
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "62186c10-6775-4da9-a164-4be1d75ef7aa"
                      },
                      "type": "IncrementVariable",
                      "inputs": {
                        "name": "varRentalIncomeEligible",
                        "value": "@if(empty(string(item()?['vl_rentalincome'])),0,item()?['vl_rentalincome'])"
                      }
                    },
                    "Increment_varWorkersCompensationEligible_Application": {
                      "runAfter": {
                        "Increment_varRentalIncomeEligible_Application": [
                          "Succeeded"
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "2c20be6c-7836-46d0-abe9-4b2b5288dc20"
                      },
                      "type": "IncrementVariable",
                      "inputs": {
                        "name": "varWorkersCompensationEligible",
                        "value": "@if(empty(string(item()?['vl_workerscompensation'])),0,item()?['vl_workerscompensation'])"
                      }
                    },
                    "Increment_varGrossIncome_Application": {
                      "runAfter": {
                        "Increment_varWorkersCompensationEligible_Application": [
                          "Succeeded"
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "ca8b34a9-a855-466c-b9d8-43f50084719b"
                      },
                      "type": "IncrementVariable",
                      "inputs": {
                        "name": "varGrossIncome",
                        "value": "@if(empty(string(item()?['vl_grossincome'])),0,item()?['vl_grossincome'])"
                      }
                    },
                    "Increment_varGrossIncomeEligible_Application": {
                      "runAfter": {
                        "Increment_varGrossIncome_Application": [
                          "Succeeded"
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "6541f49b-c282-41c7-b45b-ff9b0fd31f10"
                      },
                      "type": "IncrementVariable",
                      "inputs": {
                        "name": "varGrossIncomeEligible",
                        "value": "@if(empty(string(item()?['vl_grosseligibleincome'])),0,item()?['vl_grosseligibleincome'])"
                      }
                    },
                    "Increment_varTaxDeduction_Application": {
                      "runAfter": {
                        "Increment_varGrossIncomeEligible_Application": [
                          "Succeeded"
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "855e1f1d-7ff5-4fd5-ad90-1f58dd236f0d"
                      },
                      "type": "IncrementVariable",
                      "inputs": {
                        "name": "varTaxDeduction",
                        "value": "@if(empty(string(item()?['vl_taxdedution'])),0,item()?['vl_taxdedution'])"
                      }
                    },
                    "Increment_varNegativeGearing_Application": {
                      "runAfter": {
                        "Increment_varTaxDeduction_Application": [
                          "Succeeded"
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "4e6e87f7-558d-4a14-ae9a-2d2b6622a743"
                      },
                      "type": "IncrementVariable",
                      "inputs": {
                        "name": "varNegativeGearing",
                        "value": "@if(empty(string(item()?['vl_negativegearing'])),0,item()?['vl_negativegearing'])"
                      }
                    },
                    "Increment_varTaxableIncome_Application": {
                      "runAfter": {
                        "Increment_varNegativeGearing_Application": [
                          "Succeeded"
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "20857216-ff46-459a-92a0-b7007a06b780"
                      },
                      "type": "IncrementVariable",
                      "inputs": {
                        "name": "varTaxableIncome",
                        "value": "@if(empty(string(item()?['vl_taxableincome'])),0,item()?['vl_taxableincome'])"
                      }
                    },
                    "Increment_varNetAnnualIncome_Applications": {
                      "runAfter": {
                        "Increment_varMedicareLevy_Application": [
                          "Succeeded"
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "1cc7ffe4-6945-4cfe-8d74-0d95ce354f95"
                      },
                      "type": "IncrementVariable",
                      "inputs": {
                        "name": "varNetAnnualIncome",
                        "value": "@if(empty(string(item()?['vl_netannualincome'])),0,item()?['vl_netannualincome'])"
                      }
                    },
                    "Increment_varEmploymentIncomeCreditAdjustment_Applications": {
                      "runAfter": {
                        "Increment_varNetAnnualIncome_Applications": [
                          "Succeeded"
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "22d75f41-95b4-4d65-8ab6-dbc53dd34c8a"
                      },
                      "type": "IncrementVariable",
                      "inputs": {
                        "name": "varEmploymentIncomeCreditAdjustment",
                        "value": "@if(empty(string(item()?['vl_creditadjustmentapplied'])),0,item()?['vl_creditadjustmentapplied'])"
                      }
                    },
                    "Increment_varExpenseCreditAdjustment_Applications": {
                      "runAfter": {
                        "Increment_varEmploymentIncomeCreditAdjustment_Applications": [
                          "Succeeded"
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "49ffb606-45ef-432a-8401-fe4846c6c8c4"
                      },
                      "type": "IncrementVariable",
                      "inputs": {
                        "name": "varExpenseCreditAdjustment",
                        "value": "@if(empty(string(item()?['vl_livingexpensecreditadjustment'])),0,item()?['vl_livingexpensecreditadjustment'])"
                      }
                    },
                    "Increment_varLivingExpense_Applications": {
                      "runAfter": {
                        "Increment_varExpenseCreditAdjustment_Applications": [
                          "Succeeded"
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "521f407e-f141-4e6c-add5-8e6fbcd6acad"
                      },
                      "type": "IncrementVariable",
                      "inputs": {
                        "name": "varLivingExpense",
                        "value": "@if(empty(string(item()?['vl_livingexpense'])),0,item()?['vl_livingexpense'])"
                      }
                    },
                    "Increment_varTotalTax_Application": {
                      "runAfter": {
                        "Increment_varTaxableIncome_Application": [
                          "Succeeded"
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "393a89ab-6154-479f-9276-ec93c86c3b35"
                      },
                      "type": "IncrementVariable",
                      "inputs": {
                        "name": "varTotalTax",
                        "value": "@if(empty(string(item()?['vl_incometax'])),0,item()?['vl_incometax'])"
                      }
                    },
                    "Increment_varMedicareLevy_Application": {
                      "runAfter": {
                        "Increment_varTotalTax_Application": [
                          "Succeeded"
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "fbd8d26b-5461-4ea3-858e-967771b31de2"
                      },
                      "type": "IncrementVariable",
                      "inputs": {
                        "name": "varMedicareLevy",
                        "value": "@if(empty(string(item()?['vl_medicarelevy'])),0,item()?['vl_medicarelevy'])"
                      }
                    }
                  },
                  "runAfter": {
                    "Get_Applicant_Serviceability_Details": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "9bb2e4f8-c961-408a-b110-6be500334c1b"
                  },
                  "type": "Foreach"
                },
                "Reset_varNetAnnualIncome_2": {
                  "runAfter": {
                    "Reset_varMedicareLevy_2": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "92d5c0d9-5497-44b4-b24f-433a50f50549"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varNetAnnualIncome",
                    "value": 0
                  }
                },
                "Reset_varGrossIncome_2": {
                  "runAfter": {
                    "Reset_varGrossIncomeEligible_2": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "e9aaac69-9adc-478f-9237-e03ae7282927"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varGrossIncome",
                    "value": 0
                  }
                },
                "Reset_varTotalTax_2": {
                  "runAfter": {
                    "Reset_varTaxableIncome_2": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "165c0738-dd82-4fef-8c35-fc3bac71f269"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varTotalTax",
                    "value": 0
                  }
                },
                "Reset_varMedicareLevy_2": {
                  "runAfter": {
                    "Reset_varTotalTax_2": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "7a6f8b0f-14e7-4c57-a80c-ba5235473173"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varMedicareLevy",
                    "value": 0
                  }
                }
              },
              "runAfter": {
                "For_Each_Applicants": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "3e13170d-ad8e-4ff2-acaa-90ad289d2f82"
              },
              "type": "Scope"
            },
            "Asset": {
              "actions": {
                "Get_Assets_Details": {
                  "runAfter": {},
                  "metadata": {
                    "operationMetadataId": "11efab9b-00f7-4a71-8962-a0a8de96da02"
                  },
                  "type": "OpenApiConnection",
                  "inputs": {
                    "host": {
                      "connectionName": "shared_commondataserviceforapps",
                      "operationId": "ListRecords",
                      "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                    },
                    "parameters": {
                      "entityName": "vl_assetses",
                      "$filter": "_vl_applicationid_value eq '@{triggerOutputs()?['body/_vl_applicationid_value']}' and vl_tobeusedassecurity eq true"
                    },
                    "authentication": "@parameters('$authentication')"
                  }
                },
                "For_Each_Assets": {
                  "foreach": "@outputs('Get_Assets_Details')?['body/value']",
                  "actions": {
                    "Increment_varPropertyEstimate": {
                      "runAfter": {},
                      "metadata": {
                        "operationMetadataId": "f60a2a43-8255-4d8f-8d56-1a0fad3dca55"
                      },
                      "type": "IncrementVariable",
                      "inputs": {
                        "name": "varPropertyEstimate",
                        "value": "@if(empty(string(item()?['vl_estimatevalue'])),0,item()?['vl_estimatevalue'])"
                      }
                    },
                    "Increment_variable": {
                      "runAfter": {
                        "Increment_varPropertyEstimate": [
                          "Succeeded"
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "24a80388-b1c8-4891-ae37-c6f9b02a53cc"
                      },
                      "type": "IncrementVariable",
                      "inputs": {
                        "name": "varNewRepayment",
                        "value": "@items('For_Each_Assets')?['vl_newloanamountassessmentmonthlyrepayment']"
                      }
                    },
                    "Increment_variable_3": {
                      "runAfter": {
                        "Increment_variable": [
                          "Succeeded"
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "b26ff274-562d-48a8-8510-12ae441ffc8a"
                      },
                      "type": "IncrementVariable",
                      "inputs": {
                        "name": "varTotalDebtBalanceNewCommitments",
                        "value": "@outputs('Get_Application_Details')?['body/vl_requiredloanamount']"
                      }
                    }
                  },
                  "runAfter": {
                    "Get_Assets_Details": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "b664b6ee-a074-4c36-9e63-2b9720302c83"
                  },
                  "type": "Foreach"
                }
              },
              "runAfter": {
                "Get_Tax_Brackets": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "35242d76-d897-4a1d-9c98-9e81ee96ac2e"
              },
              "type": "Scope"
            },
            "For_Each_Liabilities_Application": {
              "foreach": "@outputs('Get_Liabilities_Details_Application')?['body/value']",
              "actions": {
                "Increment_varDebtBalanceCreditAdjustment_Application": {
                  "runAfter": {},
                  "metadata": {
                    "operationMetadataId": "428d137c-044d-4c86-a149-c1a72a4fed1a"
                  },
                  "type": "IncrementVariable",
                  "inputs": {
                    "name": "varDebtBalanceCreditAdjustment",
                    "value": "@if(empty(string(item()?['vl_creditadjustmentfordebtbalance'])),0,item()?['vl_creditadjustmentfordebtbalance'])"
                  }
                },
                "Increment_varRepayment_CreditAdjustment": {
                  "runAfter": {
                    "Increment_varDebtBalanceCreditAdjustment_Application": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "9cc9add0-b909-49bb-b35e-4b3fecf13487"
                  },
                  "type": "IncrementVariable",
                  "inputs": {
                    "name": "varRepayment",
                    "value": "@if(empty(string(item()?['vl_creditadjustmentforrepayment'])),0,item()?['vl_creditadjustmentforrepayment'])"
                  }
                },
                "Check_Asset_Type_New_Property": {
                  "actions": {
                    "Increment_varTotalDebtBalanceContinuingCommitments": {
                      "runAfter": {},
                      "metadata": {
                        "operationMetadataId": "69dcd3da-4cc0-4061-936e-2f57d5cdf820"
                      },
                      "type": "IncrementVariable",
                      "inputs": {
                        "name": "varTotalDebtBalanceContinuingCommitments",
                        "value": "@if(empty(string(items('For_Each_Liabilities_Application')?['vl_assessmentdebtbalance'])),0,items('For_Each_Liabilities_Application')?['vl_assessmentdebtbalance'])"
                      }
                    }
                  },
                  "runAfter": {
                    "Increment_varRepayment_CreditAdjustment": [
                      "Succeeded"
                    ]
                  },
                  "expression": {
                    "and": [
                      {
                        "not": {
                          "equals": [
                            "@items('For_Each_Liabilities_Application')?['vl_assettype']",
                            127420005
                          ]
                        }
                      },
                      {
                        "equals": [
                          "@items('For_Each_Liabilities_Application')?['vl_clearingfromthisloan']",
                          127420001
                        ]
                      }
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "344e64d9-0954-4a3b-8623-a21f3f6e45e3"
                  },
                  "type": "If"
                },
                "Increment_varRepayment_Except_New_Property": {
                  "runAfter": {
                    "Check_Loan_Purpose": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "8dcea342-8e3e-4d1c-a41d-a5e31ae97dcc"
                  },
                  "type": "IncrementVariable",
                  "inputs": {
                    "name": "varRepayment",
                    "value": "@if(not(equals(items('For_Each_Liabilities_Application')?['vl_assettype'],127420005)),items('For_Each_Liabilities_Application')?['vl_assessmentmonthlyrepayment'],0)"
                  }
                },
                "Increment_varDebtBalance_Except_New_Property": {
                  "runAfter": {
                    "Increment_varRepayment_Except_New_Property": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "52a62f36-2335-4885-b0be-b87ae245572b"
                  },
                  "type": "IncrementVariable",
                  "inputs": {
                    "name": "varDebtBalance",
                    "value": "@if(not(equals(items('For_Each_Liabilities_Application')?['vl_assettype'],127420005)),items('For_Each_Liabilities_Application')?['vl_assessmentdebtbalance'],0)"
                  }
                },
                "Check_Loan_Purpose": {
                  "actions": {
                    "Increment_varNewRepayment_Primary_Security": {
                      "runAfter": {},
                      "metadata": {
                        "operationMetadataId": "f3567a27-f22e-44e1-8c64-12428dc3ae57"
                      },
                      "type": "IncrementVariable",
                      "inputs": {
                        "name": "varNewRepayment",
                        "value": "@items('For_Each_Liabilities_Application')?['vl_newloanamountassessmentmonthlyrepayment']"
                      }
                    },
                    "Increment_varTotalDebtBalanceNewCommitments": {
                      "runAfter": {
                        "Increment_varNewRepayment_Primary_Security": [
                          "Succeeded"
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "2e419c18-e255-4f95-8a3e-c53abdcb5e18"
                      },
                      "type": "IncrementVariable",
                      "inputs": {
                        "name": "varTotalDebtBalanceNewCommitments",
                        "value": "@if(equals(items('For_Each_Liabilities_Application')?['vl_tobeusedassecurity'],true),outputs('Get_Application_Details')?['body/vl_requiredloanamount'],0)"
                      }
                    }
                  },
                  "runAfter": {
                    "Check_Asset_Type_New_Property": [
                      "Succeeded"
                    ]
                  },
                  "expression": {
                    "equals": [
                      1,
                      127420001
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "0ca0edc6-87f6-49ea-968a-407f38d24cb2"
                  },
                  "type": "If",
                  "description": "Currently Hidding this from calculation"
                }
              },
              "runAfter": {
                "Reset_varRepayment_2": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "79dbbb06-fb14-4f92-b4a0-c2ed8adb9dfa"
              },
              "type": "Foreach"
            },
            "Get_Liabilities_Details_Application": {
              "runAfter": {
                "For_Each_Applicants": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "bedf4abc-b89d-4f49-8f50-67f4a96549ca"
              },
              "type": "OpenApiConnection",
              "inputs": {
                "host": {
                  "connectionName": "shared_commondataserviceforapps",
                  "operationId": "ListRecords",
                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                },
                "parameters": {
                  "entityName": "vl_liabilitieses",
                  "$filter": "_vl_applicationid_value eq '@{outputs('Get_Application_Details')?['body/vl_applicationsid']}'"
                },
                "authentication": "@parameters('$authentication')"
              }
            },
            "HEM_Calculation_Couple": {
              "actions": {
                "Check_Couple_HouseHold": {
                  "actions": {
                    "Get_Expense_Details_Couple": {
                      "runAfter": {},
                      "metadata": {
                        "operationMetadataId": "ff8c6d93-4b77-4278-8c43-d59f59796e74"
                      },
                      "type": "OpenApiConnection",
                      "inputs": {
                        "host": {
                          "connectionName": "shared_commondataserviceforapps",
                          "operationId": "ListRecords",
                          "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                        },
                        "parameters": {
                          "entityName": "vl_expenses",
                          "$filter": "_vl_applicationid_value eq '@{outputs('Get_Application_Details')?['body/vl_applicationsid']}' and _vl_applicantid_value eq '@{variables('varPrimaryApplicantID')}'"
                        },
                        "authentication": "@parameters('$authentication')"
                      }
                    },
                    "Check_Expense": {
                      "actions": {
                        "Get_HEM_Details_Couple": {
                          "runAfter": {
                            "Get_Expense_Results_Couple": [
                              "Succeeded"
                            ]
                          },
                          "metadata": {
                            "operationMetadataId": "92da29ef-76f1-4f3c-bdea-593f0bb2de4a"
                          },
                          "type": "OpenApiConnection",
                          "inputs": {
                            "host": {
                              "connectionName": "shared_commondataserviceforapps",
                              "operationId": "ListRecords",
                              "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                            },
                            "parameters": {
                              "entityName": "vl_hems",
                              "$filter": "vl_hemhousehold eq @{variables('varHouseHoldType')} and vl_hemincomeminimum le @{variables('varGrossIncomeEligible')} and vl_hemincomemaximum ge @{variables('varGrossIncomeEligible')}"
                            },
                            "authentication": "@parameters('$authentication')"
                          }
                        },
                        "Set_varHEMExpense_Couple": {
                          "runAfter": {
                            "Get_HEM_Details_Couple": [
                              "Succeeded"
                            ]
                          },
                          "metadata": {
                            "operationMetadataId": "e678387d-a89a-48dc-a567-fc267f3d3e59"
                          },
                          "type": "SetVariable",
                          "inputs": {
                            "name": "varHEMExpense",
                            "value": "@if(equals(variables('varPrimaryApplicantDependants'),0),first(body('Get_HEM_Details_Couple')?['value'])?['vl_hemexpense0dependant'],if(equals(variables('varPrimaryApplicantDependants'),1),first(body('Get_HEM_Details_Couple')?['value'])?['vl_hemexpense1dependant'],if(equals(variables('varPrimaryApplicantDependants'),2),first(body('Get_HEM_Details_Couple')?['value'])?['vl_hemexpense2dependant'],if(equals(variables('varPrimaryApplicantDependants'),3),first(body('Get_HEM_Details_Couple')?['value'])?['vl_hemexpense3dependant'],if(equals(variables('varPrimaryApplicantDependants'),4),first(body('Get_HEM_Details_Couple')?['value'])?['vl_hemexpense4dependant'],if(equals(variables('varPrimaryApplicantDependants'),5),first(body('Get_HEM_Details_Couple')?['value'])?['vl_hemexpense5dependant'],if(greater(variables('varPrimaryApplicantDependants'),5),mul(variables('varPrimaryApplicantDependants'),first(body('Get_HEM_Details_Couple')?['value'])?['vl_hemexpenseperdependant']),0)))))))"
                          }
                        },
                        "Get_Expense_Results_Couple": {
                          "runAfter": {},
                          "metadata": {
                            "operationMetadataId": "c4df1212-49f2-4855-b14d-6a4d362d44ad"
                          },
                          "type": "OpenApiConnection",
                          "inputs": {
                            "host": {
                              "connectionName": "shared_commondataserviceforapps",
                              "operationId": "ListRecords",
                              "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                            },
                            "parameters": {
                              "entityName": "vl_expenseresultses",
                              "$filter": "_vl_expenseprimaryid_value eq '@{first(body('Get_Expense_Details_Couple')?['value'])?['vl_expenseid']}'"
                            },
                            "authentication": "@parameters('$authentication')"
                          }
                        },
                        "Update_HEM_Expense_Couple": {
                          "runAfter": {
                            "Set_varHEMExpense_Couple": [
                              "Failed",
                              "Skipped",
                              "TimedOut",
                              "Succeeded"
                            ]
                          },
                          "metadata": {
                            "operationMetadataId": "58f3f985-4348-4676-a170-2e02421dfebd"
                          },
                          "type": "OpenApiConnection",
                          "inputs": {
                            "host": {
                              "connectionName": "shared_commondataserviceforapps",
                              "operationId": "UpdateOnlyRecord",
                              "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                            },
                            "parameters": {
                              "entityName": "vl_expenseresultses",
                              "recordId": "@first(body('Get_Expense_Results_Couple')?['value'])?['vl_expenseresultsid']",
                              "item/vl_hem": "@div(mul(variables('varHEMExpense'),52),12)"
                            },
                            "authentication": "@parameters('$authentication')"
                          }
                        }
                      },
                      "runAfter": {
                        "Get_Expense_Details_Couple": [
                          "Succeeded"
                        ]
                      },
                      "expression": {
                        "and": [
                          {
                            "greater": [
                              "@length(body('Get_Expense_Details_Couple')?['value'])",
                              0
                            ]
                          }
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "3792df7f-1693-49d3-b18b-b09b52be6b31"
                      },
                      "type": "If"
                    }
                  },
                  "runAfter": {},
                  "expression": {
                    "or": [
                      {
                        "greater": [
                          "@length(body('Get_Applicants_Details')?['value'])",
                          1
                        ]
                      },
                      {
                        "not": {
                          "equals": [
                            "@length(body('Filter_Marital_Status'))",
                            0
                          ]
                        }
                      }
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "df959abf-8c07-42bc-ad12-d62c152d1805"
                  },
                  "type": "If"
                },
                "Get_Expense_Details_Application": {
                  "runAfter": {
                    "Check_Couple_HouseHold": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "2fe21db2-d41c-4679-b1d7-f0232d15bc53"
                  },
                  "type": "OpenApiConnection",
                  "inputs": {
                    "host": {
                      "connectionName": "shared_commondataserviceforapps",
                      "operationId": "ListRecords",
                      "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                    },
                    "parameters": {
                      "entityName": "vl_expenses",
                      "$filter": "_vl_applicationid_value eq '@{outputs('Get_Application_Details')?['body/vl_applicationsid']}'"
                    },
                    "authentication": "@parameters('$authentication')"
                  }
                },
                "For_Each_Expense_Application": {
                  "foreach": "@outputs('Get_Expense_Details_Application')?['body/value']",
                  "actions": {
                    "Get_Expense_Result_Application": {
                      "runAfter": {},
                      "metadata": {
                        "operationMetadataId": "dd2375c5-7feb-4cf4-9f72-d4713158ad95"
                      },
                      "type": "OpenApiConnection",
                      "inputs": {
                        "host": {
                          "connectionName": "shared_commondataserviceforapps",
                          "operationId": "ListRecords",
                          "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                        },
                        "parameters": {
                          "entityName": "vl_expenseresultses",
                          "$filter": "_vl_expenseprimaryid_value eq '@{items('For_Each_Expense_Application')?['vl_expenseid']}'",
                          "$top": 1
                        },
                        "authentication": "@parameters('$authentication')"
                      }
                    },
                    "Increment_varTotalHEM": {
                      "runAfter": {
                        "Get_Expense_Result_Application": [
                          "Succeeded"
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "d25ccec4-6960-49e4-b9e5-1864ea392595"
                      },
                      "type": "IncrementVariable",
                      "inputs": {
                        "name": "varTotalHEM",
                        "value": "@add(first(body('Get_Expense_Result_Application')?['value'])?['vl_totalmonthlylivinghemexpense1'],first(body('Get_Expense_Result_Application')?['value'])?['vl_totalmonthlylivinghemexpense2'])"
                      }
                    },
                    "Increment_varTotalNonHEM": {
                      "runAfter": {
                        "Increment_varTotalHEM": [
                          "Succeeded"
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "9a251e50-40ca-426a-b8c1-9845b5d268d3"
                      },
                      "type": "IncrementVariable",
                      "inputs": {
                        "name": "varTotalNonHEM",
                        "value": "@add(first(body('Get_Expense_Result_Application')?['value'])?['vl_totalmonthlylivingnonhemexpense1'],first(body('Get_Expense_Result_Application')?['value'])?['vl_totalmonthlylivingnonhemexpense2'])"
                      }
                    },
                    "Increment_varExpenseCreditAdjustment_3": {
                      "runAfter": {
                        "Increment_varTotalNonHEM": [
                          "Succeeded"
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "f78294ea-3cf1-4dea-bb0d-458b6dcfdf4c"
                      },
                      "type": "IncrementVariable",
                      "inputs": {
                        "name": "varExpenseCreditAdjustment",
                        "value": "@if(empty(string(items('For_Each_Expense_Application')?['vl_creditadjustment'])),0,items('For_Each_Expense_Application')?['vl_creditadjustment'])"
                      }
                    },
                    "Check_Primary_Applicant_For_Expense": {
                      "actions": {
                        "Set_varHEMExpense": {
                          "runAfter": {},
                          "metadata": {
                            "operationMetadataId": "185ac425-a9b2-47ba-8998-af8586a59bc6"
                          },
                          "type": "SetVariable",
                          "inputs": {
                            "name": "varHEMExpense",
                            "value": "@first(body('Get_Expense_Result_Application')?['value'])?['vl_hem']"
                          }
                        }
                      },
                      "runAfter": {
                        "Increment_varExpenseCreditAdjustment_3": [
                          "Succeeded"
                        ]
                      },
                      "expression": {
                        "equals": [
                          "@variables('varPrimaryApplicantID')",
                          "@items('For_Each_Expense_Application')?['_vl_applicantid_value']"
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "3df8cac1-5642-45fc-86a4-8ce2e8065744"
                      },
                      "type": "If"
                    }
                  },
                  "runAfter": {
                    "Reset_varExpenseCreditAdjustment_3": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "fa1c0e3f-d5ab-4643-aba4-c42b9fecbaf3"
                  },
                  "type": "Foreach"
                },
                "Reset_varExpenseCreditAdjustment_3": {
                  "runAfter": {
                    "Get_Expense_Details_Application": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "480b969b-e5c4-451b-a7e0-8a0eb73b9e07"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "varExpenseCreditAdjustment",
                    "value": 0
                  }
                },
                "Increment_varApplicationHEM": {
                  "runAfter": {
                    "For_Each_Expense_Application": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "7b4d31bf-4057-47e3-aade-1cc2a726e53b"
                  },
                  "type": "IncrementVariable",
                  "inputs": {
                    "name": "varApplicationHEM",
                    "value": "@add(add(variables('varTotalNonHEM'),variables('varExpenseCreditAdjustment')),max(variables('varHEMExpense'),variables('varTotalHEM')))"
                  }
                }
              },
              "runAfter": {
                "Application_Sericeability_Calculation": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "6070c340-3f3e-476c-bcff-dbc607c14721"
              },
              "type": "Scope"
            },
            "Get_Contribution_Details": {
              "runAfter": {
                "For_Each_Applicants": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "d45d76f6-cdb9-4dfb-8b47-9240bdaa76c1"
              },
              "type": "OpenApiConnection",
              "inputs": {
                "host": {
                  "connectionName": "shared_commondataserviceforapps",
                  "operationId": "ListRecords",
                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                },
                "parameters": {
                  "entityName": "vl_contributionfundses",
                  "$filter": "_vl_applicationid_value eq '@{outputs('Get_Application_Details')?['body/vl_applicationsid']}'"
                },
                "authentication": "@parameters('$authentication')"
              }
            },
            "For_Each_Contribution_Funds": {
              "foreach": "@outputs('Get_Contribution_Details')?['body/value']",
              "actions": {
                "Increment_varContributionFunds": {
                  "runAfter": {},
                  "metadata": {
                    "operationMetadataId": "9ff354e5-66cf-46aa-960f-d768cfb1f64a"
                  },
                  "type": "IncrementVariable",
                  "inputs": {
                    "name": "varContributionFunds",
                    "value": "@if(empty(string(items('For_Each_Contribution_Funds')?['vl_amount'])),0,items('For_Each_Contribution_Funds')?['vl_amount'])"
                  }
                }
              },
              "runAfter": {
                "Get_Contribution_Details": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "43528a6d-0f99-4c80-9681-580462e63622"
              },
              "type": "Foreach"
            },
            "Serviceability_Result": {
              "actions": {
                "Net_Monthly_Surplus_Value": {
                  "runAfter": {
                    "Check_Property_Estimate_For_LVR": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "48600371-c5b1-4522-b0cf-4792267afe22"
                  },
                  "type": "Compose",
                  "inputs": "@sub(div(variables('varNetAnnualIncome'),12), add(add(variables('varApplicationHem'),variables('varRepayment')),variables('varNewRepayment')))"
                },
                "Net_Monthly_Surplus_Result": {
                  "runAfter": {
                    "Net_Monthly_Surplus_Value": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "84e755b5-293a-4099-9e71-c5e2b80d1e27"
                  },
                  "type": "Compose",
                  "inputs": "@if(greaterOrEquals(outputs('Net_Monthly_Surplus_Value'),variables('varMinNetMonthlySurplus')),127420000,127420001)"
                },
                "Add_Application_Serviceability_Results": {
                  "runAfter": {
                    "Net_Monthly_Surplus_Result": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "cec8d631-2f68-4906-9930-e5a20287f944"
                  },
                  "type": "OpenApiConnection",
                  "inputs": {
                    "host": {
                      "connectionName": "shared_commondataserviceforapps",
                      "operationId": "CreateRecord",
                      "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                    },
                    "parameters": {
                      "entityName": "vl_serviceabilities",
                      "item/vl_annuities": "@variables('varAnnuities')",
                      "item/vl_ApplicationID@odata.bind": "/vl_applicationses(@{outputs('Get_Application_Details')?['body/vl_applicationsid']})",
                      "item/vl_childmaintenace": "@variables('varChildMaintananceEligible')",
                      "item/vl_creditadjustmentapplied": "@variables('varEmploymentIncomeCreditAdjustment')",
                      "item/vl_debtservingratiodsr": "@outputs('DSR_Value')",
                      "item/vl_debtservingratioresult": "@outputs('DSR_Result')",
                      "item/vl_debttoincomeratiodti": "@outputs('DTI_Value')",
                      "item/vl_debttoincomeratioresult": "@outputs('DTI_Result')",
                      "item/vl_dividends": "@variables('varDividendsEligible')",
                      "item/vl_foreignsourced": "@variables('varForeignSourcedEligible')",
                      "item/vl_governmentbenefits": "@variables('varGovtBenefitsEligible')",
                      "item/vl_grosseligibleincome": "@variables('varGrossIncomeEligible')",
                      "item/vl_grossincome": "@variables('varGrossIncome')",
                      "item/vl_incometax": "@variables('varTotalTax')",
                      "item/vl_investmentincome": "@variables('varInvestmentIncomeEligible')",
                      "item/vl_livingexpense": "@variables('varApplicationHEM')",
                      "item/vl_livingexpensecreditadjustment": "@variables('varExpenseCreditAdjustment')",
                      "item/vl_loanamount": "@variables('varLoanAmount')",
                      "item/vl_loanterm": "@outputs('Get_Application_Details')?['body/vl_loanterm']",
                      "item/vl_loantoincomeratiolti": "@outputs('LTI_Value')",
                      "item/vl_loantoincomeratioresult": "@outputs('LTI_Result')",
                      "item/vl_loantovalueratiolvr": "@outputs('LVR_Value')",
                      "item/vl_loantovalueratioresult": "@outputs('LVR_Result')",
                      "item/vl_medicarelevy": "@variables('varMedicareLevy')",
                      "item/vl_negativegearing": "@variables('varNegativeGearing')",
                      "item/vl_netannualincome": "@variables('varNetAnnualIncome')",
                      "item/vl_netmonthlysurplus": "@outputs('Net_Monthly_Surplus_Value')",
                      "item/vl_netmonthlysurplusresult": "@outputs('Net_Monthly_Surplus_Result')",
                      "item/vl_numberofapplicants": "@length(body('Get_Applicants_Details')?['value'])",
                      "item/vl_numberofdependents": "@variables('varDependants')",
                      "item/vl_otherincome": "@variables('varOtherIncomeEligible')",
                      "item/vl_paygincome": "@variables('varPAYGIncomeEligible')",
                      "item/vl_rentalincome": "@variables('varRentalIncomeEligible')",
                      "item/vl_selfemployedincome": "@variables('varSelfEmployedIncomeEligible')",
                      "item/vl_serviceabilityresulttype": 127420000,
                      "item/vl_serviceabilitystatus": true,
                      "item/statuscode": 1,
                      "item/vl_taxdeduction": "@variables('varTaxDeduction')",
                      "item/vl_taxableincome": "@variables('varTaxableIncome')",
                      "item/vl_totalcontinuingcommitments": "@variables('varRepayment')",
                      "item/vl_totaldebtbalancefromcontinuingcommitments": "@variables('varTotalDebtBalanceContinuingCommitments')",
                      "item/vl_totaldebtbalancefromnewcommitments": "@variables('varTotalDebtBalanceNewCommitments')",
                      "item/vl_totalrepaymentfromcontinuingcommitments": "@variables('varRepayment')",
                      "item/vl_totalrepaymentfromnewcommitments": "@variables('varNewRepayment')",
                      "item/vl_unemployedincome": "@variables('varUnEmployedIncomeEligible')",
                      "item/vl_workerscompensation": "@variables('varWorkersCompensationEligible')"
                    },
                    "authentication": "@parameters('$authentication')"
                  }
                },
                "Update_Serviceability_Trigger": {
                  "runAfter": {
                    "Add_Application_Serviceability_Results": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "2233ce59-38fc-4179-9b91-93cb3cf1ff81"
                  },
                  "type": "OpenApiConnection",
                  "inputs": {
                    "host": {
                      "connectionName": "shared_commondataserviceforapps",
                      "operationId": "UpdateOnlyRecord",
                      "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                    },
                    "parameters": {
                      "entityName": "vl_workflowqueues",
                      "recordId": "@triggerOutputs()?['body/vl_workflowqueueid']",
                      "item/vl_response": 127420000,
                      "item/vl_responsemessage": "Serviceability ran successfully"
                    },
                    "authentication": "@parameters('$authentication')"
                  }
                },
                "Check_Repayment_For_DSR": {
                  "actions": {
                    "DSR_Value": {
                      "runAfter": {},
                      "metadata": {
                        "operationMetadataId": "b274c736-f7ec-40a1-8404-13caef124e4c"
                      },
                      "type": "Compose",
                      "inputs": "@div(sub(div(variables('varNetAnnualIncome'), 12),variables('varApplicationHEM')), add(variables('varNewRepayment'),variables('varRepayment')))"
                    },
                    "DSR_Result": {
                      "runAfter": {
                        "DSR_Value": [
                          "Succeeded"
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "d95b3f57-818e-4ff4-bb02-5e1d805e4cf4"
                      },
                      "type": "Compose",
                      "inputs": "@if(and(greaterOrEquals(outputs('DSR_Value'),variables('varMinDSR')),lessOrEquals(outputs('DSR_Value'),variables('varMaxDSR'))),'127420000','127420001')"
                    }
                  },
                  "runAfter": {},
                  "expression": {
                    "or": [
                      {
                        "and": [
                          {
                            "not": {
                              "equals": [
                                "@variables('varRepayment')",
                                0
                              ]
                            }
                          },
                          {
                            "not": {
                              "equals": [
                                "@variables('varRepayment')",
                                "@null"
                              ]
                            }
                          }
                        ]
                      },
                      {
                        "and": [
                          {
                            "not": {
                              "equals": [
                                "@variables('varNewRepayment')",
                                0
                              ]
                            }
                          },
                          {
                            "not": {
                              "equals": [
                                "@variables('varNewRepayment')",
                                "@null"
                              ]
                            }
                          }
                        ]
                      }
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "d2a59fbc-135b-4de3-8443-4fca07a21bd5"
                  },
                  "type": "If"
                },
                "Check_GrossIncomeEligible_For_DTI_LTI": {
                  "actions": {
                    "DTI_Value": {
                      "runAfter": {},
                      "metadata": {
                        "operationMetadataId": "74f9053d-3950-41c0-bc4e-0c0a51bab469"
                      },
                      "type": "Compose",
                      "inputs": "@div(add(variables('varDebtBalance'),variables('varLoanAmount')) , variables('varGrossIncomeEligible'))"
                    },
                    "DTI_Result": {
                      "runAfter": {
                        "DTI_Value": [
                          "Succeeded"
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "5a5e6c53-128a-4654-9e10-c67255d5b397"
                      },
                      "type": "Compose",
                      "inputs": "@if(and(greaterOrEquals(outputs('DTI_Value'), variables('varMinDTI')), lessOrEquals(outputs('DTI_Value'), variables('varMaxDTI'))), '127420000', '127420001')"
                    },
                    "LTI_Value": {
                      "runAfter": {
                        "DTI_Result": [
                          "Succeeded"
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "8a08fa63-3cf8-4d65-a687-77defe735231"
                      },
                      "type": "Compose",
                      "inputs": "@div(variables('varLoanAmount'),variables('varGrossIncomeEligible'))"
                    },
                    "LTI_Result": {
                      "runAfter": {
                        "LTI_Value": [
                          "Succeeded"
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "524fd16a-9b2d-4c84-9128-41bf06c449ff"
                      },
                      "type": "Compose",
                      "inputs": "@if(and(greaterOrEquals(outputs('LTI_Value'), variables('varMinLTI')), lessOrEquals(outputs('LTI_Value'), variables('varMaxLTI'))), '127420000', '127420001')"
                    }
                  },
                  "runAfter": {
                    "Check_Repayment_For_DSR": [
                      "Succeeded"
                    ]
                  },
                  "expression": {
                    "and": [
                      {
                        "not": {
                          "equals": [
                            "@variables('varGrossIncomeEligible')",
                            0
                          ]
                        }
                      },
                      {
                        "not": {
                          "equals": [
                            "@variables('varGrossIncomeEligible')",
                            "@null"
                          ]
                        }
                      }
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "740b8b5d-e0c7-47b9-b1d0-a3eb5526b8e8"
                  },
                  "type": "If"
                },
                "Check_Property_Estimate_For_LVR": {
                  "actions": {
                    "LVR_Value": {
                      "runAfter": {},
                      "metadata": {
                        "operationMetadataId": "c4539d3f-aa42-49a7-9d48-4ca0ddc741d4"
                      },
                      "type": "Compose",
                      "inputs": "@mul(div(variables('varLoanAmount'),variables('varPropertyEstimate')),100)"
                    },
                    "LVR_Result": {
                      "runAfter": {
                        "LVR_Value": [
                          "Succeeded"
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "f97cf1d9-f1c3-42d6-8fb0-c9694f83f3cb"
                      },
                      "type": "Compose",
                      "inputs": "@if(and(greaterOrEquals(outputs('LVR_Value'),variables('varMinLVR')), lessOrEquals(outputs('LVR_Value'),variables('varMaxLVR'))), '127420000', '127420001')"
                    }
                  },
                  "runAfter": {
                    "Check_GrossIncomeEligible_For_DTI_LTI": [
                      "Succeeded"
                    ]
                  },
                  "expression": {
                    "and": [
                      {
                        "not": {
                          "equals": [
                            "@variables('varPropertyEstimate')",
                            0
                          ]
                        }
                      },
                      {
                        "not": {
                          "equals": [
                            "@variables('varPropertyEstimate')",
                            "@null"
                          ]
                        }
                      }
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "cd0999ff-19c8-49a4-8d87-dd550f11fa9c"
                  },
                  "type": "If"
                }
              },
              "runAfter": {
                "Asset": [
                  "Succeeded",
                  "Failed",
                  "Skipped",
                  "TimedOut"
                ],
                "HEM_Calculation_Couple": [
                  "Succeeded"
                ],
                "For_Each_Liabilities_Application": [
                  "Succeeded"
                ],
                "For_Each_Contribution_Funds": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "7dde2bb7-6cb6-4bdc-8181-1ec377ba44df"
              },
              "type": "Scope"
            },
            "Set_varLoanAmount": {
              "runAfter": {
                "Get_Application_Details": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "19e4a7e5-4562-48d0-a5a5-05ffa6fd424d"
              },
              "type": "SetVariable",
              "inputs": {
                "name": "varLoanAmount",
                "value": "@outputs('Get_Application_Details')?['body/vl_requiredloanamount']"
              }
            },
            "Reset_varDebtBalance_2": {
              "runAfter": {
                "Get_Liabilities_Details_Application": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "7e11e4e7-4cdd-40f2-a490-c37ffbfa2a65"
              },
              "type": "SetVariable",
              "inputs": {
                "name": "varDebtBalance",
                "value": 0
              }
            },
            "Reset_varDebtBalanceCreditAdjustment_2": {
              "runAfter": {
                "Reset_varDebtBalance_2": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "0ec831c4-8d7f-49d9-a1b8-b60de57c159e"
              },
              "type": "SetVariable",
              "inputs": {
                "name": "varDebtBalanceCreditAdjustment",
                "value": 0
              }
            },
            "Reset_varRepayment_2": {
              "runAfter": {
                "Reset_varDebtBalanceCreditAdjustment_2": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "3242f351-7f98-4c30-8407-e712b26c1a6c"
              },
              "type": "SetVariable",
              "inputs": {
                "name": "varRepayment",
                "value": 0
              }
            },
            "Get_Serviceability_Results": {
              "runAfter": {
                "Get_Tax_Brackets": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "444a3142-ca31-4180-b0f2-96e2d792d825"
              },
              "type": "OpenApiConnection",
              "inputs": {
                "host": {
                  "connectionName": "shared_commondataserviceforapps",
                  "operationId": "ListRecords",
                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                },
                "parameters": {
                  "entityName": "vl_serviceabilities",
                  "$filter": "_vl_applicationid_value eq '@{outputs('Get_Application_Details')?['body/vl_applicationsid']}'"
                },
                "authentication": "@parameters('$authentication')"
              }
            },
            "For_Each_Serviceability_Results": {
              "foreach": "@outputs('Get_Serviceability_Results')?['body/value']",
              "actions": {
                "Delete_a_row": {
                  "runAfter": {},
                  "metadata": {
                    "operationMetadataId": "b0886a2f-0477-4992-a6f5-dc5ccf9991da"
                  },
                  "type": "OpenApiConnection",
                  "inputs": {
                    "host": {
                      "connectionName": "shared_commondataserviceforapps",
                      "operationId": "DeleteRecord",
                      "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                    },
                    "parameters": {
                      "entityName": "vl_serviceabilities",
                      "recordId": "@items('For_Each_Serviceability_Results')?['vl_serviceabilityid']"
                    },
                    "authentication": "@parameters('$authentication')"
                  }
                }
              },
              "runAfter": {
                "Get_Serviceability_Results": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "96f85030-2247-4bed-aace-a3e9f2d756bc"
              },
              "type": "Foreach"
            }
          },
          "runAfter": {
            "Initialize_varApplicationHEM": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "5de584cf-4c5e-4bdf-9235-da791eb38bb0"
          },
          "type": "Scope"
        },
        "Initialize_varMinNetMonthlySurplus": {
          "runAfter": {
            "Initialize_varLoanAmount": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "b9ccc426-4f6e-432f-b89f-d3f4db30dbf3"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "varMinNetMonthlySurplus",
                "type": "float",
                "value": 0
              }
            ]
          }
        },
        "Initialize_varMinDTI": {
          "runAfter": {
            "Initialize_varMinNetMonthlySurplus": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "7cef943b-7b81-4162-ad71-5e3d718768fd"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "varMinDTI",
                "type": "float",
                "value": 0
              }
            ]
          }
        },
        "Initialize_varMaxDTI": {
          "runAfter": {
            "Initialize_varMinDTI": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "9122e687-a308-4d6f-9297-53c0146c33da"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "varMaxDTI",
                "type": "float",
                "value": 0
              }
            ]
          }
        },
        "Initialize_varMinDSR": {
          "runAfter": {
            "Initialize_varMaxDTI": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "f3e7afbd-22b4-4130-8450-ee5b122ac598"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "varMinDSR",
                "type": "float",
                "value": 0
              }
            ]
          }
        },
        "Initialize_varMaxDSR": {
          "runAfter": {
            "Initialize_varMinDSR": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "85746998-fe0f-465f-8522-254b7abf10ae"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "varMaxDSR",
                "type": "float",
                "value": 0
              }
            ]
          }
        },
        "Initialize_varMinLTI": {
          "runAfter": {
            "Initialize_varMaxDSR": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "6c205959-ce90-4678-9f13-ac00ee540552"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "varMinLTI",
                "type": "float",
                "value": 0
              }
            ]
          }
        },
        "Initialize_varMaxLTI": {
          "runAfter": {
            "Initialize_varMinLTI": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "85419a8b-614e-452d-97a9-c59dbecdfa08"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "varMaxLTI",
                "type": "float",
                "value": 0
              }
            ]
          }
        },
        "Initialize_varMinLVR": {
          "runAfter": {
            "Initialize_varMaxLTI": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "e2dba6b4-1935-45db-b548-e3781ef5d299"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "varMinLVR",
                "type": "float",
                "value": 0
              }
            ]
          }
        },
        "Initialize_varMaxLVR": {
          "runAfter": {
            "Initialize_varMinLVR": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "d80bacd6-4677-418a-aed4-9013999fc34a"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "varMaxLVR",
                "type": "float",
                "value": 0
              }
            ]
          }
        },
        "Initialize_varPAYGIncome": {
          "runAfter": {
            "Initialize_varMaxLVR": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "839982bd-316b-4694-9a14-b07f42c96c85"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "varPAYGIncome",
                "type": "float",
                "value": 0
              }
            ]
          }
        },
        "Initialize_varSelfEmployedIncome": {
          "runAfter": {
            "Initialize_varPAYGIncomeEligible": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "d41cb5b0-2fdf-41b9-a037-a791ba666f91"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "varSelfEmployedIncome",
                "type": "float",
                "value": 0
              }
            ]
          }
        },
        "Initialize_varUnEmployedIncome": {
          "runAfter": {
            "Initialize_varSelfEmployedIncomeEligible": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "f7779ccc-f807-45e0-bae0-480db810761b"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "varUnEmployedIncome",
                "type": "float",
                "value": 0
              }
            ]
          }
        },
        "Initialize_varAnnuities": {
          "runAfter": {
            "varUnEmployedIncomeEligible": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "56fa9643-1dd8-4d09-838b-3491e7df3c4a"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "varAnnuities",
                "type": "float",
                "value": 0
              }
            ]
          }
        },
        "Initialize_varChildMaintanance": {
          "runAfter": {
            "Initialize_varAnnuitiesEligible": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "c4d6ea89-eb33-4b26-a5a4-d46f6753e06e"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "varChildMaintanance",
                "type": "float",
                "value": 0
              }
            ]
          }
        },
        "Initialize_varDividends": {
          "runAfter": {
            "Initialize_varChildMaintananceEligible": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "a8b7117a-e2d8-4eac-8734-6731ab8eeb8f"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "varDividends",
                "type": "float",
                "value": 0
              }
            ]
          }
        },
        "Initialize_varForeignSourced": {
          "runAfter": {
            "Initialize_varDividendsEligible": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "8b178ff2-bc40-48c8-b86d-7ad01ff7c3b5"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "varForeignSourced",
                "type": "float",
                "value": 0
              }
            ]
          }
        },
        "Initialize_varGovtBenefits": {
          "runAfter": {
            "Initialize_varForeignSourcedEligible": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "f1c659dd-53a5-4728-88c6-a3557d220c1d"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "varGovtBenefits",
                "type": "float",
                "value": 0
              }
            ]
          }
        },
        "Initialize_varInvestmentIncome": {
          "runAfter": {
            "Initialize_varGovtBenefitsEligible": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "08c3f41b-288d-4ab2-ad80-ad29447cd1c5"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "varInvestmentIncome",
                "type": "float",
                "value": 0
              }
            ]
          }
        },
        "Initialize_varOtherIncome": {
          "runAfter": {
            "Initialize_varInvestmentIncomeEligible": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "6269d575-f6f1-4ee3-8db4-1a76bd7ce4dd"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "varOtherIncome",
                "type": "float",
                "value": 0
              }
            ]
          }
        },
        "Initialize_varRentalIncome": {
          "runAfter": {
            "Initialize_varOtherIncomeEligible": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "04cf4c54-4435-4830-bd3c-c6f7b9a44f42"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "varRentalIncome",
                "type": "float",
                "value": 0
              }
            ]
          }
        },
        "Initialize_varWorkersCompensation": {
          "runAfter": {
            "Initialize_varRentalIncomeEligible": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "cd90c74e-790a-4eea-93fb-7f7886df2a5c"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "varWorkersCompensation",
                "type": "float",
                "value": 0
              }
            ]
          }
        },
        "Initialize_varGrossIncome": {
          "runAfter": {
            "Initialize_varWorkersCompensationEligible": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "0be6fabf-1775-40da-9132-4b7cad986956"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "varGrossIncome",
                "type": "float",
                "value": 0
              }
            ]
          }
        },
        "Initialize_varGrossEligibleIncome": {
          "runAfter": {
            "Initialize_varGrossIncome": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "a8d39ace-2769-4327-950c-3fa38276c7aa"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "varGrossIncomeEligible",
                "type": "float",
                "value": 0
              }
            ]
          }
        },
        "Initialize_varPAYGIncomeEligible": {
          "runAfter": {
            "Initialize_varPAYGIncome": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "864af2e9-d693-47a7-848c-a498161c277f"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "varPAYGIncomeEligible",
                "type": "float",
                "value": 0
              }
            ]
          }
        },
        "Initialize_varSelfEmployedIncomeEligible": {
          "runAfter": {
            "Initialize_varSelfEmployedIncome": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "d0bbb9e7-292a-42b5-ab99-edf8b3fbd5cd"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "varSelfEmployedIncomeEligible",
                "type": "float",
                "value": 0
              }
            ]
          }
        },
        "varUnEmployedIncomeEligible": {
          "runAfter": {
            "Initialize_varUnEmployedIncome": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "ef7c4292-b610-4f60-9a9d-77a3b495f1d5"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "varUnEmployedIncomeEligible",
                "type": "float",
                "value": 0
              }
            ]
          }
        },
        "Initialize_varAnnuitiesEligible": {
          "runAfter": {
            "Initialize_varAnnuities": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "f7e150e6-63b9-4e21-a8e3-648b8ebc35f2"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "varAnnuitiesEligible",
                "type": "float",
                "value": 0
              }
            ]
          }
        },
        "Initialize_varChildMaintananceEligible": {
          "runAfter": {
            "Initialize_varChildMaintanance": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "c5d1a34d-a4b1-4a4b-bf4c-c241f23544d0"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "varChildMaintananceEligible",
                "type": "float",
                "value": 0
              }
            ]
          }
        },
        "Initialize_varDividendsEligible": {
          "runAfter": {
            "Initialize_varDividends": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "0f10235e-598d-4a3e-9398-2fdc9fb8a726"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "varDividendsEligible",
                "type": "float",
                "value": 0
              }
            ]
          }
        },
        "Initialize_varForeignSourcedEligible": {
          "runAfter": {
            "Initialize_varForeignSourced": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "2b80ffc9-c1c1-46ca-a666-87193d3c29d6"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "varForeignSourcedEligible",
                "type": "float",
                "value": 0
              }
            ]
          }
        },
        "Initialize_varGovtBenefitsEligible": {
          "runAfter": {
            "Initialize_varGovtBenefits": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "828bd476-d405-49fc-91af-8cd6654ab687"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "varGovtBenefitsEligible",
                "type": "float",
                "value": 0
              }
            ]
          }
        },
        "Initialize_varInvestmentIncomeEligible": {
          "runAfter": {
            "Initialize_varInvestmentIncome": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "03cea73c-10b4-4eda-9705-1e3a46484b80"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "varInvestmentIncomeEligible",
                "type": "float",
                "value": 0
              }
            ]
          }
        },
        "Initialize_varOtherIncomeEligible": {
          "runAfter": {
            "Initialize_varOtherIncome": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "09f93006-5541-4f27-af7d-305efb6b3151"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "varOtherIncomeEligible",
                "type": "float",
                "value": 0
              }
            ]
          }
        },
        "Initialize_varRentalIncomeEligible": {
          "runAfter": {
            "Initialize_varRentalIncome": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "c66362aa-38fe-4d50-bae9-4a3b20cb912c"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "varRentalIncomeEligible",
                "type": "float",
                "value": 0
              }
            ]
          }
        },
        "Initialize_varWorkersCompensationEligible": {
          "runAfter": {
            "Initialize_varWorkersCompensation": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "12956590-ea4a-480f-a5ff-42c746e66688"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "varWorkersCompensationEligible",
                "type": "float",
                "value": 0
              }
            ]
          }
        },
        "Initialize_varEmploymentIncomeCreditAdjustment": {
          "runAfter": {
            "Initialize_varGrossEligibleIncome": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "832f1aa0-69a0-458b-ad40-e10ef7b549cc"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "varEmploymentIncomeCreditAdjustment",
                "type": "float",
                "value": 0
              }
            ]
          }
        },
        "Initialize_varDebtBalance": {
          "runAfter": {
            "Initialize_varPAYGEmploymentIncomeCreditAdjustment": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "d7b8eaa0-16c1-433a-be5c-0fa93204badc"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "varDebtBalance",
                "type": "float",
                "value": 0
              }
            ]
          }
        },
        "Initialize_varDebtBalanceCreditAdjustment": {
          "runAfter": {
            "Initialize_varDebtBalance": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "eca8f61d-2266-4d64-8a8b-9baf7bce425c"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "varDebtBalanceCreditAdjustment",
                "type": "float",
                "value": 0
              }
            ]
          }
        },
        "Initialize_varRepayment": {
          "runAfter": {
            "Initialize_varDebtBalanceCreditAdjustment": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "5844b014-bd27-4795-9acc-1f9a629cf915"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "varRepayment",
                "type": "float",
                "value": 0
              }
            ]
          }
        },
        "Initialize_varNewRepayment": {
          "runAfter": {
            "Initialize_varRepayment": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "2f04a278-5fa1-40f4-bed0-a746151efa08"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "varNewRepayment",
                "type": "float",
                "value": 0
              }
            ]
          }
        },
        "Initialize_varNegativeGearing": {
          "runAfter": {
            "Initialize_varNewRepayment": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "815ff4ea-49f5-41b5-ad1b-b9e0ae006aea"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "varNegativeGearing",
                "type": "float",
                "value": 0
              }
            ]
          }
        },
        "Initialize_varTaxDeduction": {
          "runAfter": {
            "Initialize_varNegativeGearing": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "fa52f09c-e1c1-432b-a719-2c67f77b0b4f"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "varTaxDeduction",
                "type": "float",
                "value": 0
              }
            ]
          }
        },
        "Initialize_varLivingExpense": {
          "runAfter": {
            "Initialize_varTaxDeduction": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "0559bca7-9983-4e14-bc18-497125ab7930"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "varLivingExpense",
                "type": "float",
                "value": 0
              }
            ]
          }
        },
        "Initialize_varExpenseCreditAdjustment": {
          "runAfter": {
            "Initialize_varLivingExpense": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "522fbef5-445b-464c-b578-4c2fde257414"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "varExpenseCreditAdjustment",
                "type": "float",
                "value": 0
              }
            ]
          }
        },
        "Initialize_varHouseHoldType": {
          "runAfter": {
            "Initialize_varExpenseCreditAdjustment": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "c28b2f15-41a2-4eb2-85ac-26a51538c11f"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "varHouseHoldType",
                "type": "string"
              }
            ]
          }
        },
        "Initialize_varHEMExpense": {
          "runAfter": {
            "Initialize_varDependants": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "3f4ae0a7-c6f3-4268-ad45-7b7becb802b9"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "varHEMExpense",
                "type": "float",
                "value": 0
              }
            ]
          }
        },
        "Initialize_varTaxableIncome": {
          "runAfter": {
            "Initialize_varHEMExpense": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "f0e55497-f102-4eb7-be05-e0c834e43ae0"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "varTaxableIncome",
                "type": "float",
                "value": 0
              }
            ]
          }
        },
        "Initialize_varPropertyEstimate": {
          "runAfter": {
            "Initialize_varTaxableIncome": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "ee4b3e1f-8d97-4625-99e7-369b33256e10"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "varPropertyEstimate",
                "type": "float",
                "value": 0
              }
            ]
          }
        },
        "Initialize_varPrimaryApplicantID": {
          "runAfter": {
            "Initialize_varPropertyEstimate": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "f5896dc8-993c-4dfa-8b78-4e38ed21e385"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "varPrimaryApplicantID",
                "type": "string"
              }
            ]
          }
        },
        "Initialize_varPrimaryApplicantDependants": {
          "runAfter": {
            "Initialize_varPrimaryApplicantID": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "f8aa3efa-65e9-4427-b21d-e73cf4fc8337"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "varPrimaryApplicantDependants",
                "type": "integer"
              }
            ]
          }
        },
        "Initialize_varTaxRate": {
          "runAfter": {
            "Initialize_varPrimaryApplicantDependants": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "e6b2d511-f15b-46a8-85a0-273d791ff173"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "varTaxRate",
                "type": "float",
                "value": 0
              }
            ]
          }
        },
        "Initialize_varMedicareLevy": {
          "runAfter": {
            "Initialize_varTaxRate": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "c5c9a662-960d-45da-9100-677d98284fa2"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "varMedicareLevy",
                "type": "float",
                "value": 0
              }
            ]
          }
        },
        "Initialize_varTaxBracketMinimum": {
          "runAfter": {
            "Initialize_varMedicareLevy": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "308a8c9a-9cd8-4dcc-b4c8-69e56a9a703f"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "varTaxBracketMinimum",
                "type": "float",
                "value": 0
              }
            ]
          }
        },
        "Initialize_varTaxBracketMaximum": {
          "runAfter": {
            "Initialize_varTaxBracketMinimum": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "0baaa1da-9a1b-4be4-aee7-e188bd8078a5"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "varTaxBracketMaximum",
                "type": "float",
                "value": 0
              }
            ]
          }
        },
        "Initialize_varMinimumTax": {
          "runAfter": {
            "Initialize_varTaxBracketMaximum": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "70aff4e9-4b88-4a61-9915-e54ebedf65b5"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "varMinimumTax",
                "type": "float",
                "value": 0
              }
            ]
          }
        },
        "Initialize_varTotalTax": {
          "runAfter": {
            "Initialize_varMinimumTax": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "2501370b-17ee-4dd3-af4b-bbd21f743bd7"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "varTotalTax",
                "type": "float",
                "value": 0
              }
            ]
          }
        },
        "Initialize_varPreviousTaxBracketMaximum": {
          "runAfter": {
            "Initialize_varTotalTax": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "008c36b0-33ca-4358-8181-e1a0af355df9"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "varPreviousTaxBracketMaximum",
                "type": "float",
                "value": 0
              }
            ]
          }
        },
        "Initialize_varNetAnnualIncome": {
          "runAfter": {
            "Initialize_varPreviousTaxBracketMaximum": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "5e6bdf3f-2c0f-4e47-8e8a-561bd2477b61"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "varNetAnnualIncome",
                "type": "float",
                "value": 0
              }
            ]
          }
        },
        "Initialize_varTotalDebtBalanceContinuingCommitments": {
          "runAfter": {
            "Initialize_varNetAnnualIncome": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "94cf9146-bacd-4249-9208-e74cca70b60f"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "varTotalDebtBalanceContinuingCommitments",
                "type": "float",
                "value": 0
              }
            ]
          }
        },
        "Initialize_varTotalDebtBalanceNewCommitments": {
          "runAfter": {
            "Initialize_varTotalDebtBalanceContinuingCommitments": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "90ceeafa-639d-4e5d-8e2c-795842799258"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "varTotalDebtBalanceNewCommitments",
                "type": "float",
                "value": 0
              }
            ]
          }
        },
        "Initialize_varContributionFunds": {
          "runAfter": {
            "Initialize_varTotalDebtBalanceNewCommitments": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "51774144-4ab9-426f-b14b-c2c187e23c12"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "varContributionFunds",
                "type": "float",
                "value": 0
              }
            ]
          }
        },
        "Initialize_varTotalHEM": {
          "runAfter": {
            "Initialize_varContributionFunds": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "b26dce2b-d7c0-40a3-967b-c2f34ea56e65"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "varTotalHEM",
                "type": "float",
                "value": 0
              }
            ]
          }
        },
        "Initialize_varTotalNonHEM": {
          "runAfter": {
            "Initialize_varTotalHEM": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "42e4829d-3618-4a89-8cf5-06e560cf8133"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "varTotalNonHEM",
                "type": "float",
                "value": 0
              }
            ]
          }
        },
        "Initialize_varServiceabilityHEM": {
          "runAfter": {
            "Initialize_varTotalNonHEM": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "dd1faf22-b321-4eae-aea0-0d1aec7fee8f"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "varServiceabilityHEM",
                "type": "float",
                "value": 0
              }
            ]
          }
        },
        "Initialize_varApplicationHEM": {
          "runAfter": {
            "Initialize_varServiceabilityHEM": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "2cfdb8aa-e85c-4653-bd2e-bc5a3e2da948"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "varApplicationHEM",
                "type": "float",
                "value": 0
              }
            ]
          }
        },
        "Initialize_varLoanAmount": {
          "runAfter": {},
          "metadata": {
            "operationMetadataId": "3f2e0525-e806-43f9-842c-96bca8ecceca"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "varLoanAmount",
                "type": "float"
              }
            ]
          }
        },
        "On_Error": {
          "actions": {
            "Update_Trigger": {
              "runAfter": {},
              "metadata": {
                "operationMetadataId": "eb22c723-406d-448f-96b8-37b0b10be84e"
              },
              "type": "OpenApiConnection",
              "inputs": {
                "host": {
                  "connectionName": "shared_commondataserviceforapps",
                  "operationId": "UpdateOnlyRecord",
                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                },
                "parameters": {
                  "entityName": "vl_workflowqueues",
                  "recordId": "@triggerOutputs()?['body/vl_workflowqueueid']",
                  "item/vl_response": 127420001,
                  "item/vl_responsemessage": "Serviceability calculation failled"
                },
                "authentication": "@parameters('$authentication')"
              }
            },
            "Filter_Error_Details": {
              "runAfter": {
                "Update_Trigger": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "e4010728-1451-4b08-93a0-6496c8012142"
              },
              "type": "Query",
              "inputs": {
                "from": "@result('Main')",
                "where": "@equals(item()?['status'], 'Failed')"
              }
            },
            "Add_Error_Details": {
              "runAfter": {
                "Filter_Error_Details": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "efbf99dd-ae63-4176-aa12-e0aff88e7a81"
              },
              "type": "OpenApiConnection",
              "inputs": {
                "host": {
                  "connectionName": "shared_commondataserviceforapps",
                  "operationId": "CreateRecord",
                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                },
                "parameters": {
                  "entityName": "vl_errorhandlings",
                  "item/vl_component": "@first(body('Filter_Error_Details'))?['name']",
                  "item/vl_errorcode": "@first(body('Filter_Error_Details'))?['error']?['code']",
                  "item/vl_errormessage": "@first(body('Filter_Error_Details'))?['error']?['message']",
                  "item/vl_errorsource": 127420001,
                  "item/vl_sourcename": "@workflow().tags.flowDisplayName"
                },
                "authentication": "@parameters('$authentication')"
              }
            }
          },
          "runAfter": {
            "Main": [
              "Skipped",
              "TimedOut",
              "Failed"
            ]
          },
          "metadata": {
            "operationMetadataId": "8fcf1607-8339-41bf-a1ba-9b3f120ede3b"
          },
          "type": "Scope"
        },
        "Initialize_varDependants": {
          "runAfter": {
            "Initialize_varHouseHoldType": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "77bee2f2-99eb-41f4-9b4b-d9beee0defd5"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "varDependants",
                "type": "integer",
                "value": 0
              }
            ]
          }
        },
        "Initialize_varPAYGEmploymentIncomeCreditAdjustment": {
          "runAfter": {
            "Initialize_varEmploymentIncomeCreditAdjustment": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "39782703-c11e-47ae-a736-eb6e3bcd9e00"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "varPAYGEmploymentIncomeCreditAdjustment",
                "type": "float",
                "value": 0
              }
            ]
          }
        }
      }
    },
    "templateName": ""
  },
  "schemaVersion": "1.0.0.0"
}